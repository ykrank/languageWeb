<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>离线资源协议1.0版 | 产品文档</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.3.4">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../../../software_process/design/offline/offline_resource_design_server.html" />
    
    
    <link rel="prev" href="../../../software_process/design/offline/Introduction.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../../gitbook/style.css">


        
    <div class="book" data-level="8.2.1" data-basepath="../../.." data-revision="1463048464910">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="hg_guide/Introduction.html">
            
                
                    <a href="../../../hg_guide/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         代码提交
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="hg_guide/commit_specification.html">
            
                
                    <a href="../../../hg_guide/commit_specification.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         代码提交规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="hg_guide/how_mercurial_works.html">
            
                
                    <a href="../../../hg_guide/how_mercurial_works.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         mercurial基本原理
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="hg_guide/mercurial_commands.html">
            
                
                    <a href="../../../hg_guide/mercurial_commands.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         mercurial使用教程
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="coding_convention/c++.html">
            
                
                    <a href="../../../coding_convention/c++.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         编码规范
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="coding_convention/c++.html">
            
                
                    <a href="../../../coding_convention/c++.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         c++编码规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="coding_convention/client_development_specification.html">
            
                
                    <a href="../../../coding_convention/client_development_specification.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         客户端开发规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="coding_convention/android_convention.html">
            
                
                    <a href="../../../coding_convention/android_convention.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         android开发规范
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="code_review/code_review_points.html">
            
                
                    <a href="../../../code_review/code_review_points.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         代码评审
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="code_review/ios/FAQ.html">
            
                
                    <a href="../../../code_review/ios/FAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         FAQ(iOS)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="ci_guide/Introduction.html">
            
                
                    <a href="../../../ci_guide/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         持续集成
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="ci_guide/jenkins.html">
            
                
                    <a href="../../../ci_guide/jenkins.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Jenkins持续集成
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="ci_guide/deploy.html">
            
                
                    <a href="../../../ci_guide/deploy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Jenkins持续发布
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="ci_guide/ClientBuild.html">
            
                
                    <a href="../../../ci_guide/ClientBuild.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         客户端构建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="ci_guide/sonarqube.html">
            
                
                    <a href="../../../ci_guide/sonarqube.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         Sonar代码质量检测
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.5" data-path="ci_guide/Phabricator.html">
            
                
                    <a href="../../../ci_guide/Phabricator.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Code Review
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.6" data-path="ci_guide/Appium.html">
            
                
                    <a href="../../../ci_guide/Appium.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                         UI自动化测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.7" data-path="ci_guide/ldap.html">
            
                
                    <a href="../../../ci_guide/ldap.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                         LDAP服务部署和集成
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.8" data-path="ci_guide/p_code.html">
            
                
                    <a href="../../../ci_guide/p_code.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                         个人构建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9" data-path="ci_guide/tools/Introduction.html">
            
                
                    <a href="../../../ci_guide/tools/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                         持续集成依赖工具
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.9.1" data-path="ci_guide/tools/brew.html">
            
                
                    <a href="../../../ci_guide/tools/brew.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.1.</b>
                        
                         Homebrew安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.2" data-path="ci_guide/tools/install_jdk.html">
            
                
                    <a href="../../../ci_guide/tools/install_jdk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.2.</b>
                        
                         JDK安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.3" data-path="ci_guide/tools/install_sdk.html">
            
                
                    <a href="../../../ci_guide/tools/install_sdk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.3.</b>
                        
                         Android SDK安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.4" data-path="ci_guide/tools/install_tomcat.html">
            
                
                    <a href="../../../ci_guide/tools/install_tomcat.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.4.</b>
                        
                         Tomcat安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.5" data-path="ci_guide/tools/maven.html">
            
                
                    <a href="../../../ci_guide/tools/maven.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.5.</b>
                        
                         Maven构建工具
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.6" data-path="ci_guide/tools/nexus.html">
            
                
                    <a href="../../../ci_guide/tools/nexus.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.6.</b>
                        
                         Nexus依赖仓库
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.7" data-path="ci_guide/tools/Ansible.html">
            
                
                    <a href="../../../ci_guide/tools/Ansible.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.7.</b>
                        
                         Asible服务集群部署
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="code_server/Introduction.html">
            
                
                    <a href="../../../code_server/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         代码服务器
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1" data-path="code_server/deploy.html">
            
                
                    <a href="../../../code_server/deploy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         代码服务器部署
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2" data-path="code_server/hghook.html">
            
                
                    <a href="../../../code_server/hghook.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         hghook脚本安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3" data-path="code_server/pmmm_functions.html">
            
                
                    <a href="../../../code_server/pmmm_functions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         PMMM插件功能列表
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4" data-path="code_server/trac_sqlite_to_mysql.html">
            
                
                    <a href="../../../code_server/trac_sqlite_to_mysql.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                         Trac迁移Sqlite到MySQL
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="tech/tech_wordpress.html">
            
                
                    <a href="../../../tech/tech_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         技术期刊
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1" data-path="tech/tech_wordpress.html">
            
                
                    <a href="../../../tech/tech_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         技术期刊Wordpress搭建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="tech/mail_wordpress.html">
            
                
                    <a href="../../../tech/mail_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                         Wordpress安装邮件服务
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="software_process/requirement/Introduction.html">
            
                
                    <a href="../../../software_process/requirement/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         需求文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" >
            
            <span><b>7.1.</b> 离线资源</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1.1" data-path="software_process/requirement/offline/security_optimization_of_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/security_optimization_of_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.1.</b>
                        
                         离线资源安全优化需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.2" data-path="software_process/requirement/offline/multi_app_support_of_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/multi_app_support_of_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.2.</b>
                        
                         离线多App需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.3" data-path="software_process/requirement/offline/websocket_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/websocket_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.3.</b>
                        
                         离线Websocket下载需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.4" data-path="software_process/requirement/offline/single_optional_resource_dl_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/single_optional_resource_dl_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.4.</b>
                        
                         离线可选资源单个文件下载需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.5" data-path="software_process/requirement/offline/offline4.0_supplement.html">
            
                
                    <a href="../../../software_process/requirement/offline/offline4.0_supplement.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.5.</b>
                        
                         离线4.0补充需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.6" data-path="software_process/requirement/5.3/multi_encrypted_tunnels.html">
            
                
                    <a href="../../../software_process/requirement/5.3/multi_encrypted_tunnels.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.6.</b>
                        
                         多信道需求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="software_process/requirement/EMP/touchevent/touchEventRequirement.html">
            
                
                    <a href="../../../software_process/requirement/EMP/touchevent/touchEventRequirement.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                         TouchEvent事件监听需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.3" data-path="software_process/requirement/client_anti_replaying.html">
            
                
                    <a href="../../../software_process/requirement/client_anti_replaying.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                         客户端防重放需求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="software_process/design/Introduction.html">
            
                
                    <a href="../../../software_process/design/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         设计文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" >
            
            <span><b>8.1.</b> 文件上传</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1.1" data-path="software_process/design/EWP/server_design_of_uploading_file.html">
            
                
                    <a href="../../../software_process/design/EWP/server_design_of_uploading_file.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.1.</b>
                        
                         服务端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2" data-path="software_process/design/offline/Introduction.html">
            
                
                    <a href="../../../software_process/design/offline/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                         离线资源
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="8.2.1" data-path="software_process/design/offline/offline_resource.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.</b>
                        
                         离线资源协议1.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.1.1" data-path="software_process/design/offline/offline_resource_design_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_design_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.1.</b>
                        
                         服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.1.2" data-path="software_process/design/offline/offline_resource_design_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_design_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.2.</b>
                        
                         客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2" data-path="software_process/design/offline/offline_resource_2.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_2.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.</b>
                        
                         离线资源协议2.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.2.1" data-path="software_process/design/offline/design_of_security_optimization.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_security_optimization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.1.</b>
                        
                         离线资源2.0安全性优化设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2.2" data-path="software_process/design/offline/h5_resources_support.html">
            
                
                    <a href="../../../software_process/design/offline/h5_resources_support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.2.</b>
                        
                         离线资源2.1 H5资源支持设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2.3" data-path="software_process/design/offline/h5_resources_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/h5_resources_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.3.</b>
                        
                         离线资源2.1 H5资源支持客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.3" data-path="software_process/design/offline/offline_resource_3.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_3.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.</b>
                        
                         离线资源协议3.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.3.1" data-path="software_process/design/offline/design_of_multi_app_support_of_offline_server.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_multi_app_support_of_offline_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.1.</b>
                        
                         离线资源3.0 离线资源多App支持服务器设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.3.2" data-path="software_process/design/offline/design_of_multi_app_support_of_offline_client.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_multi_app_support_of_offline_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.2.</b>
                        
                         离线资源3.0 离线资源多App支持客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4" data-path="software_process/design/offline/offline_resource_4.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_4.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.</b>
                        
                         离线资源协议4.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.4.1" data-path="software_process/design/offline/h5_plug_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/h5_plug_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.1.</b>
                        
                         离线H5资源插件下载
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.2" data-path="software_process/design/offline/websocket_resources_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/websocket_resources_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.2.</b>
                        
                         客户端离线资源WebSocket下载支持设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.3" data-path="software_process/design/offline/offline_4_0_design_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_4_0_design_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.3.</b>
                        
                         离线资源4.0 服务器设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.4" data-path="software_process/design/offline/offline_resource_optimization_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.4.</b>
                        
                         离线资源优化-客户端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.5" data-path="software_process/design/offline/offline_resource_optimization_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.5.</b>
                        
                         离线资源优化-服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.6" data-path="software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.6.</b>
                        
                         离线资源优化-预置&amp;下载-Android
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.7" data-path="software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.7.</b>
                        
                         离线资源优化-预置&amp;下载-Android
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.8" data-path="software_process/design/offline/offline_resource_optinal_part_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optinal_part_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.8.</b>
                        
                         离线资源-可选资源增量更新
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.3" data-path="software_process/design/xmpp/Introduction.html">
            
                
                    <a href="../../../software_process/design/xmpp/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                         可靠消息
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.3.1" data-path="software_process/design/xmpp/xmpp_design_client.html">
            
                
                    <a href="../../../software_process/design/xmpp/xmpp_design_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.1.</b>
                        
                         可靠消息机制客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.4" data-path="software_process/design/editor/Introduction.html">
            
                
                    <a href="../../../software_process/design/editor/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                         Editor调试工具
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.4.1" data-path="software_process/design/editor/client/editor_client_design.html">
            
                
                    <a href="../../../software_process/design/editor/client/editor_client_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.1.</b>
                        
                         客户端Editor工具实现思路
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4.2" data-path="software_process/design/editor/client/data_transfer_old.html">
            
                
                    <a href="../../../software_process/design/editor/client/data_transfer_old.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.2.</b>
                        
                         数据传输协议(老版本)
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4.3" data-path="software_process/design/editor/client/data_transfer_new.html">
            
                
                    <a href="../../../software_process/design/editor/client/data_transfer_new.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.3.</b>
                        
                         数据传输协议(新版本)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5" data-path="software_process/design/EMP/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                         EMP设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.1" data-path="software_process/design/EMP/slt2/design_of_slt2_parsing.html">
            
                
                    <a href="../../../software_process/design/EMP/slt2/design_of_slt2_parsing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.1.</b>
                        
                         SLT2脚本解析功能总体设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.2" data-path="software_process/design/EMP/files_security/local_files_security.html">
            
                
                    <a href="../../../software_process/design/EMP/files_security/local_files_security.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.2.</b>
                        
                         客户端文件安全
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.3" data-path="software_process/design/EMP/internationalization.html">
            
                
                    <a href="../../../software_process/design/EMP/internationalization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.3.</b>
                        
                         国际化设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.4" data-path="software_process/design/EMP/screen_adaptation/screen_adaptation.html">
            
                
                    <a href="../../../software_process/design/EMP/screen_adaptation/screen_adaptation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.4.</b>
                        
                         屏幕适配设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.5" data-path="software_process/design/EMP/iOS_5.3_NativeTesting_Design.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS_5.3_NativeTesting_Design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.5.</b>
                        
                         iOS native测试设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.6" data-path="software_process/design/EMP/Android_5.3_NativeTesting_Design.html">
            
                
                    <a href="../../../software_process/design/EMP/Android_5.3_NativeTesting_Design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.6.</b>
                        
                         Android native测试设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.7" data-path="software_process/design/EMP/dom_search_optimization_scheme.html">
            
                
                    <a href="../../../software_process/design/EMP/dom_search_optimization_scheme.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.7.</b>
                        
                         DOM查找性能测试及优化方案
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.8" data-path="software_process/design/EMP/globalcss/css_global_cache.html">
            
                
                    <a href="../../../software_process/design/EMP/globalcss/css_global_cache.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.8.</b>
                        
                         CSS公共样式设计方案
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.9" data-path="software_process/design/EMP/touch_event/touch_event.html">
            
                
                    <a href="../../../software_process/design/EMP/touch_event/touch_event.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.9.</b>
                        
                         touch event事件监听设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.10" data-path="software_process/design/EMP/multitask/multitask.html">
            
                
                    <a href="../../../software_process/design/EMP/multitask/multitask.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.10.</b>
                        
                         多任务设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11" data-path="software_process/design/EMP/control_lua/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.</b>
                        
                         html设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.11.1" data-path="software_process/design/EMP/control_lua/metatable_property_degsign.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/metatable_property_degsign.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.1.</b>
                        
                         lua_property
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11.2" data-path="software_process/design/EMP/control_lua/radio_checkbox_icon_design.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/radio_checkbox_icon_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.2.</b>
                        
                         radio/checkbox icon
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11.3" data-path="software_process/design/EMP/control_lua/select_lua_design.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/select_lua_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.3.</b>
                        
                         select增加lua支持
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5.12" data-path="software_process/design/EMP/design_of_tls_rehandshake.html">
            
                
                    <a href="../../../software_process/design/EMP/design_of_tls_rehandshake.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.12.</b>
                        
                         信道重连设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.13" data-path="software_process/design/EMP/iOS/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.</b>
                        
                         iOS离线下载网路模块设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.13.1" data-path="software_process/design/EMP/iOS/offline/offline_download_websocket_process.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/offline/offline_download_websocket_process.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.1.</b>
                        
                         离线资源websocket下载过程说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.13.2" data-path="software_process/design/EMP/iOS/offline/updatehttpmanager_Instructions.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/offline/updatehttpmanager_Instructions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.2.</b>
                        
                         下载管理器UpdateHTTPManager使用说明
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5.14" data-path="software_process/design/EMP/iOS/mdap_class_relation.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/mdap_class_relation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.14.</b>
                        
                         MDAP--iOS类关系图
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.15" data-path="software_process/design/EMP/EMP_support_https_list.html">
            
                
                    <a href="../../../software_process/design/EMP/EMP_support_https_list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.15.</b>
                        
                         客户端支持多https信道
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.6" data-path="software_process/design/EWP/Introduction.html">
            
                
                    <a href="../../../software_process/design/EWP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                         EWP设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.6.1" data-path="software_process/design/EWP/design_of_anti_resubmit_service.html">
            
                
                    <a href="../../../software_process/design/EWP/design_of_anti_resubmit_service.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.1.</b>
                        
                         防重复提交设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.2" data-path="software_process/design/EWP/offline/DD_of_security_optimization.html">
            
                
                    <a href="../../../software_process/design/EWP/offline/DD_of_security_optimization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.2.</b>
                        
                         离线配置设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.3" data-path="software_process/design/EWP/offline/design_of_refactor.html">
            
                
                    <a href="../../../software_process/design/EWP/offline/design_of_refactor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.3.</b>
                        
                         离线分层设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.4" data-path="software_process/design/EWP/session/design_of_optimization_of_shared_session.html">
            
                
                    <a href="../../../software_process/design/EWP/session/design_of_optimization_of_shared_session.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.4.</b>
                        
                         Session共享概要设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.5" data-path="software_process/design/EWP/session/detailed_design_of_shared_session.html">
            
                
                    <a href="../../../software_process/design/EWP/session/detailed_design_of_shared_session.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.5.</b>
                        
                         Session共享详细设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.6" data-path="software_process/design/EWP/EAC/design_of_eac.html">
            
                
                    <a href="../../../software_process/design/EWP/EAC/design_of_eac.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.6.</b>
                        
                         EMP管理平台优化设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.7" data-path="software_process/design/EWP/design_of_client_anti_replaying.html">
            
                
                    <a href="../../../software_process/design/EWP/design_of_client_anti_replaying.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.7.</b>
                        
                         客户端防重放设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.8" data-path="software_process/design/offline/offline_resource_enhance_to_4.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_enhance_to_4.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.8.</b>
                        
                         增强版升级离线4.0服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.9" data-path="software_process/design/EMP/EWP_support_https_list.html">
            
                
                    <a href="../../../software_process/design/EMP/EWP_support_https_list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.9.</b>
                        
                         服务端支持多https信道
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="9" data-path="software_process/test/Introduction.html">
            
                
                    <a href="../../../software_process/test/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         测试文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.1" data-path="software_process/test/EWP/Introduction.html">
            
                
                    <a href="../../../software_process/test/EWP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                         EWP测试结果
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.1.1" data-path="software_process/test/EWP/httpc_test.html">
            
                
                    <a href="../../../software_process/test/EWP/httpc_test.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.1.</b>
                        
                         HTTPC接口性能测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9.1.2" data-path="software_process/test/EWP/session_share_pftest_results.html">
            
                
                    <a href="../../../software_process/test/EWP/session_share_pftest_results.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.2.</b>
                        
                         Session优化性能测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9.1.3" data-path="software_process/test/EWP/test_of_anti_resubmit_service.html">
            
                
                    <a href="../../../software_process/test/EWP/test_of_anti_resubmit_service.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.3.</b>
                        
                         防重复提交功能性能测试
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="9.2" data-path="software_process/test/EMP/Introduction.html">
            
                
                    <a href="../../../software_process/test/EMP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                         EMP测试结果
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.2.1" >
            
            <span><b>9.2.1.</b> Android</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.2.1.1" data-path="software_process/test/EMP/Android/offline/PresetResourceProcessingV3.0-PerformanceTestReport_1.1.html">
            
                
                    <a href="../../../software_process/test/EMP/Android/offline/PresetResourceProcessingV3.0-PerformanceTestReport_1.1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.1.1.</b>
                        
                         预置离线资源处理V3.0-性能测试报告
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="10" data-path="client_function/Introduction.html">
            
                
                    <a href="../../../client_function/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                         客户端其他功能
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="10.1" data-path="client_function/error_check.html">
            
                
                    <a href="../../../client_function/error_check.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         错误检测
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="11" data-path="technology_accumulation/Introduction.html">
            
                
                    <a href="../../../technology_accumulation/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                         技术积累
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="11.1" data-path="technology_accumulation/Introduction.html">
            
                
                    <a href="../../../technology_accumulation/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                         iOS
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="11.1.1" data-path="technology_accumulation/iOS/schedule.html">
            
                
                    <a href="../../../technology_accumulation/iOS/schedule.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.1.</b>
                        
                         日程安排
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.2" data-path="technology_accumulation/iOS/technical_points/loop_reference.html">
            
                
                    <a href="../../../technology_accumulation/iOS/technical_points/loop_reference.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.2.</b>
                        
                         循环引用
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.3" data-path="technology_accumulation/iOS/technical_points/table_cell_reuse.html">
            
                
                    <a href="../../../technology_accumulation/iOS/technical_points/table_cell_reuse.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.3.</b>
                        
                         tableCell重用
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.4" data-path="technology_accumulation/iOS/advanced_technology/3DTouch.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/3DTouch.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.4.</b>
                        
                         3DTouch
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.5" data-path="technology_accumulation/iOS/advanced_technology/cordova.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/cordova.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.5.</b>
                        
                         cordova
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.6" data-path="technology_accumulation/iOS/advanced_technology/touchID.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/touchID.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.6.</b>
                        
                         touchID
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.7" data-path="technology_accumulation/iOS/advanced_technology/watchOS.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/watchOS.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.7.</b>
                        
                         watchOS
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    

    
    
    
    

    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown">下载</a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                
                <a href="/emp/inner_docs/inner_docs.zip" class="button">html</a>
                
                
                <a href="/emp/inner_docs/book.pdf" class="button">pdf</a>
                
                
                <a href="" class="button">epub</a>
                
            </div>
        </div>
    </div>

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../" >产品文档</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_85">
                    
                        <h1 id="离线资源协议">离线资源协议</h1>
<!-- toc -->
<ul>
<li><a href="#设计要求">设计要求</a><ul>
<li><a href="#基本要求">基本要求</a><ul>
<li><a href="#持久化存储">持久化存储</a></li>
<li><a href="#同步机制">同步机制</a></li>
</ul>
</li>
<li><a href="#应用场景">应用场景</a><ul>
<li><a href="#资源文件存储">资源文件存储</a></li>
<li><a href="#key-value存储">Key-Value存储</a></li>
<li><a href="#统计数据存储">统计数据存储</a></li>
<li><a href="#客户端插件">客户端插件</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#技术架构设计">技术架构设计</a><ul>
<li><a href="#同步机制">同步机制</a><ul>
<li><a href="#传输协议">传输协议</a></li>
<li><a href="#更新流程">更新流程</a></li>
</ul>
</li>
<li><a href="#安全">安全</a></li>
</ul>
</li>
<li><a href="#接口说明">接口说明</a><ul>
<li><a href="#资源更新检查接口">资源更新检查接口</a></li>
<li><a href="#资源描述更新接口">资源描述更新接口</a></li>
</ul>
</li>
<li><a href="#网络请求方式">网络请求方式</a><ul>
<li><a href="#http下载">http下载</a></li>
<li><a href="#tcp下载">tcp下载</a></li>
</ul>
</li>
<li><a href="#json格式说明">JSON格式说明</a><ul>
<li><a href="#字段说明-clientoption">字段说明  clientoption</a></li>
<li><a href="#客户端上传描述格式">客户端上传描述格式</a></li>
<li><a href="#服务器返回描述格式">服务器返回描述格式</a></li>
<li><a href="#客户端已下载资源保存描述格式">客户端已下载资源保存描述格式</a></li>
<li><a href="#服务器可选资源描述在客户端的保存格式">服务器可选资源描述在客户端的保存格式</a></li>
<li><a href="#预置资源描述格式">预置资源描述格式</a></li>
</ul>
</li>
<li><a href="#服务器设计">服务器设计</a></li>
<li><a href="#客户端设计">客户端设计</a></li>
</ul>
<!-- toc stop -->
<p>本文档仅适用于离线资源1.0版本及以上版本，关于离线资源0版本的文档参见<a href="https://dev.rytong.me:9998/proj/emp/attachment/wiki/EMP5.3/EMP离线存储.docx" target="_blank">EMP离线存储.docx</a>.</p>
<h2 id="设计要求">1 设计要求</h2>
<p>离线存储需要实现EMP客户端对资源文件和用户数据的本地持久化存储，以及和EMP后台之间的数据同步机制。</p>
<h3 id="基本要求">1.1 基本要求</h3>
<h4 id="持久化存储">1.1.1 持久化存储</h4>
<p>EMP客户端需要在各智能手机平台上实现资源的持久化存储机制，并提供统一的Lua调用接口。</p>
<h4 id="同步机制">1.1.2 同步机制</h4>
<p>由于离线存储的数据部分是来自于EMP后台，这些后台存储的数据会不定期的更新并与客户端的业务流程紧密联系，因此我们需要定义EMP客户端和后台之间的同步机制，以保证离线存储数据的实时性和一致性。</p>
<h3 id="应用场景">1.2 应用场景</h3>
<h4 id="资源文件存储">1.2.1 资源文件存储</h4>
<p>资源文件指在客户端通过文件形式存储的数据，包括HTML页面文件、CSS文件、Lua以及JavaScript脚本文件、图片文件等等。
客户端通过在本地存储这些资源文件，可实现下载之后的离线运行，并通过与后台的同步机制在线更新，以实现客户端的升级。</p>
<h4 id="key-value存储">1.2.2 Key-Value存储</h4>
<p>Key-Value存储指在客户端通过Key-Value数据库存储的用户数据。这些数据通常为用户输入，需要在客户端业务流程中反复使用。</p>
<h4 id="统计数据存储">1.2.3 统计数据存储</h4>
<p>统计数据指客户端在用户使用客户端时所收集到的相关数据，这些数据通过文件形式存储，并定期的发送给统计后台。</p>
<h4 id="客户端插件">1.2.4 客户端插件</h4>
<p>客户端插件以zip压缩文件的形式提供。它属于客户端资源文件中特殊的一种，它可能包含Lua脚本、HTML页面等多个元素，以一个功能集合为单位被打包。</p>
<h2 id="技术架构设计">2 技术架构设计</h2>
<h3 id="同步机制">2.1 同步机制</h3>
<h4 id="传输协议">2.1.1 传输协议</h4>
<p>传输协议用于EMP客户端与后台之间的数据同步以保证数据的一致性。我们使用类似于版本控制的方式来实现该协议，有如下约定：</p>
<ol>
<li>后台将所有客户端需要离线存储的资源文件按照如下结构存储：
<img src="images/resource_storage_structure.png" alt="资源文件存储结构">
其中资源文件按照类型存放在不同的文件夹中，包含HTML、CSS、Lua、JavaScript、Image、Document（Key-Value数据）等。对于不同的手机及其屏幕分辨率类型，我们分别使用一个.desc文件描述其所需资源的列表状态，内容包括每个资源文件的id和rev，其中id为文件名，rev为版本号（通过SHA1计算出的hash值），.desc文件中不允许有相同id的资源文件。对于需要根据手机类型以及屏幕类型定制的同名资源，我们将其放到对应的深层次的目录结构中。对于每个手机平台的每种分辨率，都有一个.desc文件描述其资源列表。当资源发生变更时，后台需要重新计算变更资源的hash值，并更新相应的.desc文件。描述文件使用app–platform- resolution来命名，统一放在resources/resource-version/desc目录下。</li>
<li>客户端通过后台提供的更新接口来实现资源同步，将手机平台类型和分辨率作为参数传递给后台，后台通过参数匹配获取相应的.desc文件，经比对后生成下载列表download.desc。download.desc中描述了从客户端当前版本（client.desc)升级到后台最新版本（server.desc）需要更新的文件列表和下载地址。客户端按照download.desc下载完资源文件后，同本地已有的资源合并（添加新增资源，覆盖同名资源），并通过服务器返回的server.desc验证当前资源的正确性，删除过期资源文件（server.desc中没有描述的本地资源）。</li>
<li>针对某些客户端应用，如果需要防止客户端在运行过程中后台发生更新导致本地资源和后台的不一致，可要求客户端在请求某些后台业务接口时，将本地的描述文件版本号（client.desc.rev）作为参数发送给后台，由后台判断客户端当前资源版本号是否能够兼容后台现有的业务接口，如果不能兼容，则提示用户需要更新之后再使用。</li>
<li>我们为不同的客户端版本添加了一层目录结构 version（resource-version），在该文件夹下来维护一个或多个版本所需要的离线版本库，存放对应客户端版本的离线资源，以此区分不兼容的客户端版本。</li>
</ol>
<h4 id="更新流程">2.1.2 更新流程</h4>
<p><img src="images/offline_flow.png" alt=""><br>步骤解释如下：</p>
<ol>
<li>在建立加密通道（exchange或handshake）时，客户端发送资源必选资源、可选资源hash值，服务端在响应中返回比对结果.</li>
<li>根据服务器返回的内容确定后续操作.</li>
<li>请求资源描述更新接口(ota/resource_update),将客户端已下载离线资源信息上传服务器.</li>
<li>受到服务器响应后,根据<code>m</code>字段内容确定后续操作.</li>
<li>确定下载资源后,根据服务器返回的必选下载列表依次下载资源文件.</li>
<li>根据服务器返回的资源文件hash值,验证资源正确性后,更新客户端以下载的资源描述文件.并将资源保存到本地.</li>
</ol>
<h3 id="安全">2.2 安全</h3>
<p>为保证客户端本地资源的安全性，资源描述文件需要通过加密信道传递，在客户端本地加密存储。在客户端每次启动时，需要将本地存储的资源描述文件加载到内存中，当需要使用离线资源时，需要首先验证本地资源文件的SHA1值与描述文件中的SHA1值是否匹配，以防止资源文件被篡改。
当发现本地资源被篡改时，需删除本地相应的离线资源，并更新client.desc中相应的资源状态，然后重走上述的客户端离线资源更新流程。</p>
<h2 id="接口说明">3 接口说明</h2>
<p>本文档针对离线协议1版本.与0版本的区别主要有:</p>
<ol>
<li>增加resource_hash接口，并与握手接口合并.</li>
<li>修改resource_update接口参数及返回数据格式.</li>
<li>增加tcp下载方式.此方式尽从1版本中使用.</li>
<li>json报文的结构及字段名重新定义.</li>
<li>增加,调整部分lua接口.</li>
</ol>
<h3 id="资源更新检查接口">3.1 资源更新检查接口</h3>
<p>接口名称：ota/resource_hash<br>接口参数：hash, option_hash, platform, resolution<br>接口返回：0为不更新，1为必选资源描述更新, 2为可选资源描述更新, 3为必选,可选资源描述都需要更新<br>接口说明：  </p>
<ol>
<li>hash参数值为必选资源的描述经sha1算法计算出的哈希值</li>
<li>option_hash为可选资源的描述经sha1算法计算出的哈希值</li>
<li>platform为客户端平台，如android、iphone。</li>
<li>resolution为客户端分辨率，如640*960、320*480</li>
<li>返回0,说明没有内容更新.</li>
<li>返回1,说明客户端必选资源描述需要更新.</li>
<li>返回2,说明客户端保存的可选资源描述需要更新.</li>
<li>返回3,说明客户端的必选资源和可选资源描述都需要更新.</li>
<li>如在tls握手流程中检查更新，须在请求Body中增加resource_hash和resource_hash_opt消息，在url中增加platform和resolution参数。消息格式为Type(1 byte) + Length(4 bytes) + Hash(Length bytes)。resource_hash和resource_hash_opt的Type值分别为0x0C、0x0D</li>
<li>如在tls握手流程中检查更新，服务端会在响应中增加resource_hash_res消息。格式为Type(1 byte) + Length(4 bytes) + Result(Length bytes)。Type值为0x0E，Result为字符0、1、2、3加密后的内容。</li>
</ol>
<p>功能说明: 用来简易的检测是否有离线资源需要更新.服务器会为当前服务器上的必选资源和可选资源分别计算一个hash值.作为比对离线资源是否相同的标示.</p>
<p><strong>接口使用说明</strong>:  </p>
<p>前提:</p>
<ol>
<li>客户端将必选资源信息&lt;客户端保存描述格式&gt;中的格式保存在client.desc中.  </li>
<li>客户端将服务器返回的可选资源信息以&lt;服务器可选资源描述在客户端的保存格式&gt;中定义的格式保存在option_server.desc中.</li>
</ol>
<p>使用:</p>
<ol>
<li>当client.desc和option_server.desc中没有hash字段,或hash字段中内容为空或不合法时,不请求此接口,直接返回3.</li>
<li>当client.desc或option_server.desc中有hash字段,并且该值有效时,将该hash值通过ota/resource_hash上传给服务器.</li>
<li>根据ota/resource_hash接口返回的内容决定后续的操作流程.</li>
</ol>
<h3 id="资源描述更新接口">3.2 资源描述更新接口</h3>
<p>接口名称：ota/resource_update<br>接口参数：desc, platform, resolution, version, hash_res.<br>接口返回：资源描述更新详情，格式如&lt;服务器返回描述格式&gt;<br>接口说明：</p>
<ol>
<li>desc为客户端描述文件，格式为&lt;客户端上传描述格式&gt;</li>
<li>platform为客户端平台，如android、iphone。</li>
<li>resolution为客户端分辨率，如640<em>960、320</em>480</li>
<li>version为离线协议版本，初始版本为0，现（EMP5.2及以上）版本为1。默认为0</li>
<li>hash_res为resource_hash接口的返回值.如果客户端没有本地资源上次3.</li>
</ol>
<p><strong>接口使用说明</strong>: </p>
<ol>
<li>根据ota/resource_hash接口返回的内容,决定上传的内容.</li>
<li>返回1,2,3时,将client.desc中的内容整理成&lt;客户端上传描述格式&gt;的形式.通过ota/resource_update接口上传服务器</li>
<li>服务器返回&lt;服务器返回描述格式&gt;的格式报文.根据返回内容开始资源下载.</li>
</ol>
<h2 id="网络请求方式">4 网络请求方式</h2>
<p>支持两种方式的资源下载,tcp下载和http下载方式.资源文件的下载不加密也不通过加密信道.
客户端使用哪种下载方式由服务器决定.服务器在resource_update接口的返回中,会有&#39;t&#39;字段,表示tcp下载的端口号.客户端根据是否有&#39;t&#39;字段,决定使用哪种下载方式.如果有&#39;t&#39;字段使用tcp下载,反之使用http下载.
根据资源描述更新接口(ota/resource_update)返回下载列表开始资源文件的下载.
依此下载下载列表中资源.离线资源下载保持较低的优先级.</p>
<h3 id="http下载">4.1 http下载</h3>
<p>通过http方式下载离线资源.请求方式为get方式,不加密也不通过加密信道.</p>
<h3 id="tcp下载">4.2 tcp下载</h3>
<p>客户端须根据<code>h</code>和<code>t</code>字段指定的服务器地址和端口与服务端建立tcp连接。建立成功后，客户端请求下载具体资源文件，服务端根据指定的路径将资源文件内容返回给客户端。<br>客户端请求下载时上送内容为：EmpTcpVer(1 Byte)+ Length(4 Bytes) + Content。第一字节固定为1，之后4字节表示数据长度，后跟指定长度的下载文件的路径，格式为Json。
<img src="images/tcp1.png" alt="">
服务端返回内容为：EmpTcpVer(1 Byte)+ Length(4 Bytes) + Content。第一字节固定为1，之后的4字节表示文件大小，客户端须继续读取指定大小的内容来完成文件下载。
 <img src="images/tcp2.png" alt="">
服务端处理错误时向客户端返回的内容为：EmpTcpVer(1 Byte)+ 0(1 Byte) + ErrorCode(1 Byte)。第一字节固定唯一，之后表示大小的4字节固定为0，接着为1字节的错误代码。错误代码为0时表示未知错误，为1时表示无法读取指定资源文件，为2时表示无法解析客户端上送内容。返回错误信息后，服务端会主动断开连接。
 <img src="images/tcp3.png" alt="">
在所有文件下载完成后，客户端须主动断开连接。如下载过程中连接断开，客户端须根据已成功下载的文件更新本地资源描述，并重新请求客户端更新接口。
除处理错误外，服务端会在以下情况下主动断开连接：</p>
<ol>
<li>服务端向客户端发送文件时出错；</li>
<li>服务端接受客户端请求时出错。</li>
<li>连接空闲超过30秒</li>
</ol>
<p>当服务端连接数达到上限时（上限由服务端配置项设置），客户端发起的连接将会被拒绝。此时，客户端须再尝试几次建立连接，如果仍无法建立，则应转成http方式重新下载。</p>
<h2 id="json格式说明">5 JSON格式说明</h2>
<h3 id="字段说明-clientoption">5.1 字段说明  clientoption</h3>
<pre><code>a  : number类型  是否下载整个zip包，1为是，0为否。默认为1, 且如果为默认,则省略此字段。
c  : 对象        同desc             插件zip包中文件的所有描述  
d  : 数组        同delete           删除列表描述   
e  : number类型  同encrypt          文件是否加密保存 1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段   
h  : string类型  同host             服务器地址   
l  : 对象        同download         必选资源更新描述  
m  : number类型  同mustupdate       资源更新的级别.
    -1表示不需要更新,则不需要提示用户.
    0表示可选更新,即用户可以选择更新和不更新资源.弹出提示框,让用户选择更新或取消.用户取消,则结束更新流程.用户确定,则操作同3项.
    1表示必须更新,弹出提示框提示用户有资源更新,用户确定后,下载离线资源.
n  : string类型  同comment          资源说明,并非所有资源都包含此字段.只有服务器设置了描述内容的文件才会包含此字段.
t  : number类型  同tcp_port         tcp下载端口,只有tcp下载模式下才有此字段    
o  : 对象        同option_download  可选资源下载列表  
p  : 对象                           预置的可选资源描述
r  : string类型  同rev              文件sha1值   
s  : string类型  同hash             离线资源描述的hash值. 此hash值分类两种,必选资源描述的hash值,可选资源描述的hash值. 
    必选资源描述的hash值,此值在服务器返回的`l`字段中.在所有的必选资源下载成后后,将此字段内容保存到客户端client.desc中.  
    可选资源描述的hash值,此值在服务器返回可选资源描述(o字段)中,会将可选资源描述保存到option_server.desc中.
u  : number类型  同ensure_download  是否确保更新, 1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段  
dir  : string类型 表示文件下载的基础路径, 将相同基础路径的资源作为一组.如示例中的dir1  
file : string类型 表示的是文件的相对路径.比如在zip包中. zip1/css/color.cs. filen = zip1/css/color.cs
</code></pre><h3 id="客户端上传描述格式">5.2 客户端上传描述格式</h3>
<p>当需要请求服务器更新接口时,需要将客户端保存的client.desc文件内容整理成如下格式,再上传服务器.
其中仅包含文件的hash值.<br>客户端上传描述格式.<br><code>l</code> : 代表必选资源信息  </p>
<pre><code>{
 &quot;l&quot; : //必选资源上次格式
 {
   &quot;zip1.zip&quot; : 
  {
    &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; 
    &quot;c&quot; : {
      &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; 
    }
  }
  &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
 }

}
</code></pre><h3 id="服务器返回描述格式">5.3 服务器返回描述格式</h3>
<p><strong>注:</strong> 必选资源和可选资源分别有一个hash字段,用来通过简易流程检查资源更新.</p>
<pre><code>{
    &quot;h&quot;:&quot;http://127.0.0.1:4002/&quot;, //http下载地址
    &quot;t&quot;:4060, //tcp下载端口
    &quot;m&quot;:0, //资源更新提示方式。0为提示可选更新，1为提示强制更新，
                    //-1为不更新,

    &quot;l&quot; : 
    {
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;//必选资源hash 服务端计算的描述文件哈希值，所有资源下载成功后，客户端将该哈希值保存，作为ota/resource_hash接口参数使用。

       &quot;dir1&quot; :  //如: ebank/resources/common/zip
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;e&quot; : 1 //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段  
              &quot;n&quot; : &quot;插件包说明&quot;
              &quot;c&quot; : //需要下载文件的列表
              {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,如: account/xhtml/index.xml       
                {
                  &quot;r&quot; = &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                  &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
                }   
              }
            }
             &quot;zip2.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;e&quot; : 1 //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段 
              &quot;a&quot; : 1,//是否下载整个zip包，1为是，0为否。默认为1, 且如果为默认,则省略此字段。   
              &quot;c&quot; : //需要下载文件的列表
              {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,如: account/xhtml/index.xml       
                {
                  &quot;r&quot; = &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                  &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
                }   
              }
            }
            &quot;file1&quot; : // 普通资源 如: &quot;welcome.png&quot;
            {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;e&quot; : 1  //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
              &quot;u&quot; : 1 //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
              &quot;n&quot; : &quot;普通资源说明&quot;
            }

            ......//其他同目录下的资源
        }

        ......//其他目录下资源
    }

    &quot;o&quot; : {
       // 格式与dl中相同
    }

    &quot;d&quot; : 
    [
      {&quot;zip1.zip&quot; : 
      [
        &quot;file3&quot;,
        &quot;file4&quot;
      ]},

      &quot;file5&quot;,
      &quot;file6&quot;,
      &quot;zip2.zip&quot;
    ]
}
</code></pre><h3 id="客户端已下载资源保存描述格式">5.4 客户端已下载资源保存描述格式</h3>
<p>已下载资源包括必选资源,可选资源.必选资源保存在client.desc中.可选资源保存在option.desc中.<br><strong>注:</strong>  client.desc中<code>s</code>字段内容只有当客户端将所有必选资源更新成功后,才能将服务器返回的必选资源hash更新到client.desc中.<br>文件保存保存的格式如下:  </p>
<pre><code>{
    &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
    &quot;zip1.zip&quot; : 
    {
       &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
       &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
       &quot;n&quot; : &quot;插件包说明&quot;
       &quot;c&quot; : 
       {
         &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; //file1为相对于zip1的相对路径 

       }
    }
    &quot;file1&quot; : 
    {
      &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
      &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
      &quot;n&quot; : &quot;普通资源说明&quot;
    }
}
</code></pre><h3 id="服务器可选资源描述在客户端的保存格式">5.5 服务器可选资源描述在客户端的保存格式</h3>
<p>由于可选资源的下载由脚本控制,因此可选资源的下载信息需要在客户端备份.我们将服务器返回的可选资源描述保存在option_server.desc中.<br>同时增加<code>h</code>服务器地址,<code>t</code>tcp端口.当服务器没有返回离线下载相关信息时,可选资源的下载用这两个字段提供的服务器地址下载资源.当服务器返回服务器下载信息后,以服务器返回内容为准,并更新到此文件中.<br><code>s</code>,保存服务器返回的可选资源hash.
当脚本需要下载某个插件时,通过option_server.desc提供的下载路径下载插件资源,下载成功后将插件资源以&lt;客户端已下载资源保存描述格式&gt;格式保存到option.desc中.<br>option_server.desc中保存内容格式如下:</p>
<pre><code>{
    &quot;h&quot; : &quot;http://127.0.0.1:4002/&quot;, //http下载地址或tcp模式下服务器ip
    &quot;t&quot; : 4060, //tcp下载端口
    &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; //必选资源校验值

    &quot;dir1&quot; :  //如: ebank/resources/common/zip
        {
        &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;e&quot; : 1 //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段 
                &quot;n&quot; : &quot;插件包说明&quot; 
                &quot;c&quot; : //需要下载文件的列表
                {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,如: account/xhtml/index.xml       
                {
                    &quot;r&quot; = &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                    &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
                }   
                }
            }
        }
   }
</code></pre><h3 id="预置资源描述格式">5.6 预置资源描述格式</h3>
<p>预置资源描述中包含必选资源描述,可选资源描述.<br>必选资源描述与客户端的client.desc内容一致.<br>可选资源描述与服务器返回的更新描述中的可选资源描述一致.
格式说明:</p>
<p><strong>l</strong> : 已预置必选资源描述,格式与&lt;客户端保存描述格式&gt;一致.必选资源描述中包含所有预置包中的必选资源信息.
<strong>p</strong> : 已预置可选资源描述,格式与&lt;客户端保存描述格式&gt;一致.可选资源描述中包含所有预置的可选资源描述.
<strong>o</strong> : 服务器上所有可选资源描述,格式与&lt;服务器返回描述格式&gt;一致.可选资源描述中包含所有服务器中可选资源的信息.可选资源中的信息需要保存到客户端.并且在服务器返回的可选资源描述时,及时更新此文件内容.此部分内容包括tcp端口号,但不包括服务器地址,当客户端没有服务器地址信息时,如没有调用资源更新接口,可以使用TLS握手的服务器地址代替.<br><strong>s</strong> : 资源文件校验值. 分为必选资源校验值和可选资源校验值.资源校验值有服务器返回,仅用来简单的检测客户端资源是否与服务器同步.<br>预置可选资源与必选资源格式不同的原因:<br>必选资源的下载是由下载流程控制的,当有新的资源需要下载时,服务器会返回下载相关的信息,因此客户端不需要保存这些内容.<br>可选资源的下载是由脚本控制的.并且每个客户端中的可选插件可能会出现不同的情况.脚本随时都可能需要下载可选资源.因此将可选资源的所有下载信息预置到客户端.  </p>
<pre><code>{
    &quot;l&quot; : 
    {
        &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
        &quot;zip1.zip&quot; : 
        {
           &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
           &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
           &quot;n&quot; : &quot;插件包说明&quot;
           &quot;c&quot; : 
           {
             &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; //file1为相对于zip1的相对路径 

           }
        }
        &quot;file1&quot; : 
        {
          &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
          &quot;n&quot; : &quot;普通资源说明&quot;
          &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
        }
    }
    &quot;p&quot; : 
    {
        &quot;zip2.zip&quot; : 
        {
           &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
           &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
           &quot;c&quot; : 
           {
             &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; //file1为相对于zip1的相对路径 

           }
        }
    }
    &quot;o&quot; : 
    {
    &quot;t&quot;:4060, //tcp下载端口
    &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
    &quot;dir1&quot; :  //如: ebank/resources/common/zip
     {
        &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot; //可选资源校验值
        &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
         {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;e&quot; : 1 //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段  
              &quot;c&quot; : //需要下载文件的列表
              {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,如: account/xhtml/index.xml       
                {
                  &quot;r&quot; = &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                  &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
                }   
              }
          }
       }
    }
}
</code></pre><h2 id="服务器设计">6 服务器设计</h2>
<p>服务器设计参考<a href="offline_resource_design_server.html">服务器离线设计文档</a></p>
<h2 id="客户端设计">7 客户端设计</h2>
<p>客户端设计参考<a href="offline_resource_design_client.html">客户端离线设计文档</a></p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Note</th>
<th>Modifier</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-12-09</td>
<td>初版</td>
<td>lin.jitao</td>
</tr>
<tr>
<td>2015-03-19</td>
<td>离线协议更新为1.1版。为防止tcp连接端口因不可控原因被关闭，为保证离线更新顺利进行，客户端每次请求资源更新检查接口时，服务器通过返回值来表明用于资源更新的网络连接类型，及tcp模式下的端口号。</td>
<td>zhou.changjin</td>
</tr>
<tr>
<td>2015-05-15</td>
<td>将原1.1版本内容升级为2.0版，并新建文档说明，取消1.1版。</td>
<td>zhou.changjin</td>
</tr>
</tbody>
</table>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../../software_process/design/offline/Introduction.html" class="navigation navigation-prev " aria-label="Previous page: 离线资源"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../../software_process/design/offline/offline_resource_design_server.html" class="navigation navigation-next " aria-label="Next page: 服务端设计"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
