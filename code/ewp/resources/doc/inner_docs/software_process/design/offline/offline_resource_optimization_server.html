<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>离线资源优化-服务端设计 | 产品文档</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.3.4">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html" />
    
    
    <link rel="prev" href="../../../software_process/design/offline/offline_resource_optimization_client.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../../gitbook/style.css">


        
    <div class="book" data-level="8.2.4.5" data-basepath="../../.." data-revision="1463048464910">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="hg_guide/Introduction.html">
            
                
                    <a href="../../../hg_guide/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         代码提交
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.1" data-path="hg_guide/commit_specification.html">
            
                
                    <a href="../../../hg_guide/commit_specification.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         代码提交规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="hg_guide/how_mercurial_works.html">
            
                
                    <a href="../../../hg_guide/how_mercurial_works.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         mercurial基本原理
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="hg_guide/mercurial_commands.html">
            
                
                    <a href="../../../hg_guide/mercurial_commands.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         mercurial使用教程
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="coding_convention/c++.html">
            
                
                    <a href="../../../coding_convention/c++.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         编码规范
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="coding_convention/c++.html">
            
                
                    <a href="../../../coding_convention/c++.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         c++编码规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="coding_convention/client_development_specification.html">
            
                
                    <a href="../../../coding_convention/client_development_specification.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         客户端开发规范
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="coding_convention/android_convention.html">
            
                
                    <a href="../../../coding_convention/android_convention.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         android开发规范
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="code_review/code_review_points.html">
            
                
                    <a href="../../../code_review/code_review_points.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         代码评审
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="code_review/ios/FAQ.html">
            
                
                    <a href="../../../code_review/ios/FAQ.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         FAQ(iOS)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="ci_guide/Introduction.html">
            
                
                    <a href="../../../ci_guide/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         持续集成
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="ci_guide/jenkins.html">
            
                
                    <a href="../../../ci_guide/jenkins.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Jenkins持续集成
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="ci_guide/deploy.html">
            
                
                    <a href="../../../ci_guide/deploy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Jenkins持续发布
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="ci_guide/ClientBuild.html">
            
                
                    <a href="../../../ci_guide/ClientBuild.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         客户端构建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.4" data-path="ci_guide/sonarqube.html">
            
                
                    <a href="../../../ci_guide/sonarqube.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                         Sonar代码质量检测
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.5" data-path="ci_guide/Phabricator.html">
            
                
                    <a href="../../../ci_guide/Phabricator.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                         Code Review
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.6" data-path="ci_guide/Appium.html">
            
                
                    <a href="../../../ci_guide/Appium.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                         UI自动化测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.7" data-path="ci_guide/ldap.html">
            
                
                    <a href="../../../ci_guide/ldap.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                         LDAP服务部署和集成
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.8" data-path="ci_guide/p_code.html">
            
                
                    <a href="../../../ci_guide/p_code.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                         个人构建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9" data-path="ci_guide/tools/Introduction.html">
            
                
                    <a href="../../../ci_guide/tools/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.</b>
                        
                         持续集成依赖工具
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.9.1" data-path="ci_guide/tools/brew.html">
            
                
                    <a href="../../../ci_guide/tools/brew.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.1.</b>
                        
                         Homebrew安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.2" data-path="ci_guide/tools/install_jdk.html">
            
                
                    <a href="../../../ci_guide/tools/install_jdk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.2.</b>
                        
                         JDK安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.3" data-path="ci_guide/tools/install_sdk.html">
            
                
                    <a href="../../../ci_guide/tools/install_sdk.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.3.</b>
                        
                         Android SDK安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.4" data-path="ci_guide/tools/install_tomcat.html">
            
                
                    <a href="../../../ci_guide/tools/install_tomcat.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.4.</b>
                        
                         Tomcat安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.5" data-path="ci_guide/tools/maven.html">
            
                
                    <a href="../../../ci_guide/tools/maven.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.5.</b>
                        
                         Maven构建工具
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.6" data-path="ci_guide/tools/nexus.html">
            
                
                    <a href="../../../ci_guide/tools/nexus.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.6.</b>
                        
                         Nexus依赖仓库
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.9.7" data-path="ci_guide/tools/Ansible.html">
            
                
                    <a href="../../../ci_guide/tools/Ansible.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.9.7.</b>
                        
                         Asible服务集群部署
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="code_server/Introduction.html">
            
                
                    <a href="../../../code_server/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         代码服务器
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1" data-path="code_server/deploy.html">
            
                
                    <a href="../../../code_server/deploy.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         代码服务器部署
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2" data-path="code_server/hghook.html">
            
                
                    <a href="../../../code_server/hghook.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         hghook脚本安装
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3" data-path="code_server/pmmm_functions.html">
            
                
                    <a href="../../../code_server/pmmm_functions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         PMMM插件功能列表
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.4" data-path="code_server/trac_sqlite_to_mysql.html">
            
                
                    <a href="../../../code_server/trac_sqlite_to_mysql.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                         Trac迁移Sqlite到MySQL
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="tech/tech_wordpress.html">
            
                
                    <a href="../../../tech/tech_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         技术期刊
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="6.1" data-path="tech/tech_wordpress.html">
            
                
                    <a href="../../../tech/tech_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                         技术期刊Wordpress搭建
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6.2" data-path="tech/mail_wordpress.html">
            
                
                    <a href="../../../tech/mail_wordpress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                         Wordpress安装邮件服务
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="software_process/requirement/Introduction.html">
            
                
                    <a href="../../../software_process/requirement/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         需求文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1" >
            
            <span><b>7.1.</b> 离线资源</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="7.1.1" data-path="software_process/requirement/offline/security_optimization_of_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/security_optimization_of_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.1.</b>
                        
                         离线资源安全优化需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.2" data-path="software_process/requirement/offline/multi_app_support_of_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/multi_app_support_of_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.2.</b>
                        
                         离线多App需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.3" data-path="software_process/requirement/offline/websocket_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/websocket_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.3.</b>
                        
                         离线Websocket下载需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.4" data-path="software_process/requirement/offline/single_optional_resource_dl_offline.html">
            
                
                    <a href="../../../software_process/requirement/offline/single_optional_resource_dl_offline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.4.</b>
                        
                         离线可选资源单个文件下载需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.5" data-path="software_process/requirement/offline/offline4.0_supplement.html">
            
                
                    <a href="../../../software_process/requirement/offline/offline4.0_supplement.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.5.</b>
                        
                         离线4.0补充需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.1.6" data-path="software_process/requirement/5.3/multi_encrypted_tunnels.html">
            
                
                    <a href="../../../software_process/requirement/5.3/multi_encrypted_tunnels.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.6.</b>
                        
                         多信道需求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="7.2" data-path="software_process/requirement/EMP/touchevent/touchEventRequirement.html">
            
                
                    <a href="../../../software_process/requirement/EMP/touchevent/touchEventRequirement.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                         TouchEvent事件监听需求
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7.3" data-path="software_process/requirement/client_anti_replaying.html">
            
                
                    <a href="../../../software_process/requirement/client_anti_replaying.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.3.</b>
                        
                         客户端防重放需求
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="software_process/design/Introduction.html">
            
                
                    <a href="../../../software_process/design/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         设计文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1" >
            
            <span><b>8.1.</b> 文件上传</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.1.1" data-path="software_process/design/EWP/server_design_of_uploading_file.html">
            
                
                    <a href="../../../software_process/design/EWP/server_design_of_uploading_file.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.1.</b>
                        
                         服务端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2" data-path="software_process/design/offline/Introduction.html">
            
                
                    <a href="../../../software_process/design/offline/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                         离线资源
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.1" data-path="software_process/design/offline/offline_resource.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.</b>
                        
                         离线资源协议1.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.1.1" data-path="software_process/design/offline/offline_resource_design_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_design_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.1.</b>
                        
                         服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.1.2" data-path="software_process/design/offline/offline_resource_design_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_design_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.2.</b>
                        
                         客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2" data-path="software_process/design/offline/offline_resource_2.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_2.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.</b>
                        
                         离线资源协议2.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.2.1" data-path="software_process/design/offline/design_of_security_optimization.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_security_optimization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.1.</b>
                        
                         离线资源2.0安全性优化设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2.2" data-path="software_process/design/offline/h5_resources_support.html">
            
                
                    <a href="../../../software_process/design/offline/h5_resources_support.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.2.</b>
                        
                         离线资源2.1 H5资源支持设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.2.3" data-path="software_process/design/offline/h5_resources_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/h5_resources_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.3.</b>
                        
                         离线资源2.1 H5资源支持客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.3" data-path="software_process/design/offline/offline_resource_3.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_3.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.</b>
                        
                         离线资源协议3.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.3.1" data-path="software_process/design/offline/design_of_multi_app_support_of_offline_server.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_multi_app_support_of_offline_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.1.</b>
                        
                         离线资源3.0 离线资源多App支持服务器设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.3.2" data-path="software_process/design/offline/design_of_multi_app_support_of_offline_client.html">
            
                
                    <a href="../../../software_process/design/offline/design_of_multi_app_support_of_offline_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.3.2.</b>
                        
                         离线资源3.0 离线资源多App支持客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4" data-path="software_process/design/offline/offline_resource_4.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_4.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.</b>
                        
                         离线资源协议4.0版
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.2.4.1" data-path="software_process/design/offline/h5_plug_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/h5_plug_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.1.</b>
                        
                         离线H5资源插件下载
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.2" data-path="software_process/design/offline/websocket_resources_support_client.html">
            
                
                    <a href="../../../software_process/design/offline/websocket_resources_support_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.2.</b>
                        
                         客户端离线资源WebSocket下载支持设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.3" data-path="software_process/design/offline/offline_4_0_design_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_4_0_design_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.3.</b>
                        
                         离线资源4.0 服务器设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.4" data-path="software_process/design/offline/offline_resource_optimization_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.4.</b>
                        
                         离线资源优化-客户端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="8.2.4.5" data-path="software_process/design/offline/offline_resource_optimization_server.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_server.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.5.</b>
                        
                         离线资源优化-服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.6" data-path="software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.6.</b>
                        
                         离线资源优化-预置&amp;下载-Android
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.7" data-path="software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.7.</b>
                        
                         离线资源优化-预置&amp;下载-Android
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.2.4.8" data-path="software_process/design/offline/offline_resource_optinal_part_client.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_optinal_part_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.4.8.</b>
                        
                         离线资源-可选资源增量更新
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.3" data-path="software_process/design/xmpp/Introduction.html">
            
                
                    <a href="../../../software_process/design/xmpp/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                         可靠消息
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.3.1" data-path="software_process/design/xmpp/xmpp_design_client.html">
            
                
                    <a href="../../../software_process/design/xmpp/xmpp_design_client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.1.</b>
                        
                         可靠消息机制客户端设计
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.4" data-path="software_process/design/editor/Introduction.html">
            
                
                    <a href="../../../software_process/design/editor/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                         Editor调试工具
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.4.1" data-path="software_process/design/editor/client/editor_client_design.html">
            
                
                    <a href="../../../software_process/design/editor/client/editor_client_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.1.</b>
                        
                         客户端Editor工具实现思路
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4.2" data-path="software_process/design/editor/client/data_transfer_old.html">
            
                
                    <a href="../../../software_process/design/editor/client/data_transfer_old.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.2.</b>
                        
                         数据传输协议(老版本)
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.4.3" data-path="software_process/design/editor/client/data_transfer_new.html">
            
                
                    <a href="../../../software_process/design/editor/client/data_transfer_new.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.3.</b>
                        
                         数据传输协议(新版本)
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5" data-path="software_process/design/EMP/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                         EMP设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.1" data-path="software_process/design/EMP/slt2/design_of_slt2_parsing.html">
            
                
                    <a href="../../../software_process/design/EMP/slt2/design_of_slt2_parsing.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.1.</b>
                        
                         SLT2脚本解析功能总体设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.2" data-path="software_process/design/EMP/files_security/local_files_security.html">
            
                
                    <a href="../../../software_process/design/EMP/files_security/local_files_security.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.2.</b>
                        
                         客户端文件安全
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.3" data-path="software_process/design/EMP/internationalization.html">
            
                
                    <a href="../../../software_process/design/EMP/internationalization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.3.</b>
                        
                         国际化设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.4" data-path="software_process/design/EMP/screen_adaptation/screen_adaptation.html">
            
                
                    <a href="../../../software_process/design/EMP/screen_adaptation/screen_adaptation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.4.</b>
                        
                         屏幕适配设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.5" data-path="software_process/design/EMP/iOS_5.3_NativeTesting_Design.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS_5.3_NativeTesting_Design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.5.</b>
                        
                         iOS native测试设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.6" data-path="software_process/design/EMP/Android_5.3_NativeTesting_Design.html">
            
                
                    <a href="../../../software_process/design/EMP/Android_5.3_NativeTesting_Design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.6.</b>
                        
                         Android native测试设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.7" data-path="software_process/design/EMP/dom_search_optimization_scheme.html">
            
                
                    <a href="../../../software_process/design/EMP/dom_search_optimization_scheme.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.7.</b>
                        
                         DOM查找性能测试及优化方案
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.8" data-path="software_process/design/EMP/globalcss/css_global_cache.html">
            
                
                    <a href="../../../software_process/design/EMP/globalcss/css_global_cache.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.8.</b>
                        
                         CSS公共样式设计方案
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.9" data-path="software_process/design/EMP/touch_event/touch_event.html">
            
                
                    <a href="../../../software_process/design/EMP/touch_event/touch_event.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.9.</b>
                        
                         touch event事件监听设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.10" data-path="software_process/design/EMP/multitask/multitask.html">
            
                
                    <a href="../../../software_process/design/EMP/multitask/multitask.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.10.</b>
                        
                         多任务设计文档
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11" data-path="software_process/design/EMP/control_lua/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.</b>
                        
                         html设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.11.1" data-path="software_process/design/EMP/control_lua/metatable_property_degsign.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/metatable_property_degsign.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.1.</b>
                        
                         lua_property
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11.2" data-path="software_process/design/EMP/control_lua/radio_checkbox_icon_design.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/radio_checkbox_icon_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.2.</b>
                        
                         radio/checkbox icon
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.11.3" data-path="software_process/design/EMP/control_lua/select_lua_design.html">
            
                
                    <a href="../../../software_process/design/EMP/control_lua/select_lua_design.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.11.3.</b>
                        
                         select增加lua支持
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5.12" data-path="software_process/design/EMP/design_of_tls_rehandshake.html">
            
                
                    <a href="../../../software_process/design/EMP/design_of_tls_rehandshake.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.12.</b>
                        
                         信道重连设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.13" data-path="software_process/design/EMP/iOS/Introduction.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.</b>
                        
                         iOS离线下载网路模块设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.5.13.1" data-path="software_process/design/EMP/iOS/offline/offline_download_websocket_process.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/offline/offline_download_websocket_process.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.1.</b>
                        
                         离线资源websocket下载过程说明
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.13.2" data-path="software_process/design/EMP/iOS/offline/updatehttpmanager_Instructions.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/offline/updatehttpmanager_Instructions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.13.2.</b>
                        
                         下载管理器UpdateHTTPManager使用说明
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.5.14" data-path="software_process/design/EMP/iOS/mdap_class_relation.html">
            
                
                    <a href="../../../software_process/design/EMP/iOS/mdap_class_relation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.14.</b>
                        
                         MDAP--iOS类关系图
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.5.15" data-path="software_process/design/EMP/EMP_support_https_list.html">
            
                
                    <a href="../../../software_process/design/EMP/EMP_support_https_list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.15.</b>
                        
                         客户端支持多https信道
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="8.6" data-path="software_process/design/EWP/Introduction.html">
            
                
                    <a href="../../../software_process/design/EWP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                         EWP设计
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="8.6.1" data-path="software_process/design/EWP/design_of_anti_resubmit_service.html">
            
                
                    <a href="../../../software_process/design/EWP/design_of_anti_resubmit_service.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.1.</b>
                        
                         防重复提交设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.2" data-path="software_process/design/EWP/offline/DD_of_security_optimization.html">
            
                
                    <a href="../../../software_process/design/EWP/offline/DD_of_security_optimization.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.2.</b>
                        
                         离线配置设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.3" data-path="software_process/design/EWP/offline/design_of_refactor.html">
            
                
                    <a href="../../../software_process/design/EWP/offline/design_of_refactor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.3.</b>
                        
                         离线分层设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.4" data-path="software_process/design/EWP/session/design_of_optimization_of_shared_session.html">
            
                
                    <a href="../../../software_process/design/EWP/session/design_of_optimization_of_shared_session.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.4.</b>
                        
                         Session共享概要设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.5" data-path="software_process/design/EWP/session/detailed_design_of_shared_session.html">
            
                
                    <a href="../../../software_process/design/EWP/session/detailed_design_of_shared_session.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.5.</b>
                        
                         Session共享详细设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.6" data-path="software_process/design/EWP/EAC/design_of_eac.html">
            
                
                    <a href="../../../software_process/design/EWP/EAC/design_of_eac.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.6.</b>
                        
                         EMP管理平台优化设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.7" data-path="software_process/design/EWP/design_of_client_anti_replaying.html">
            
                
                    <a href="../../../software_process/design/EWP/design_of_client_anti_replaying.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.7.</b>
                        
                         客户端防重放设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.8" data-path="software_process/design/offline/offline_resource_enhance_to_4.0.html">
            
                
                    <a href="../../../software_process/design/offline/offline_resource_enhance_to_4.0.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.8.</b>
                        
                         增强版升级离线4.0服务端设计
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8.6.9" data-path="software_process/design/EMP/EWP_support_https_list.html">
            
                
                    <a href="../../../software_process/design/EMP/EWP_support_https_list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.9.</b>
                        
                         服务端支持多https信道
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="9" data-path="software_process/test/Introduction.html">
            
                
                    <a href="../../../software_process/test/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         测试文档
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.1" data-path="software_process/test/EWP/Introduction.html">
            
                
                    <a href="../../../software_process/test/EWP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                         EWP测试结果
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.1.1" data-path="software_process/test/EWP/httpc_test.html">
            
                
                    <a href="../../../software_process/test/EWP/httpc_test.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.1.</b>
                        
                         HTTPC接口性能测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9.1.2" data-path="software_process/test/EWP/session_share_pftest_results.html">
            
                
                    <a href="../../../software_process/test/EWP/session_share_pftest_results.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.2.</b>
                        
                         Session优化性能测试
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9.1.3" data-path="software_process/test/EWP/test_of_anti_resubmit_service.html">
            
                
                    <a href="../../../software_process/test/EWP/test_of_anti_resubmit_service.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.3.</b>
                        
                         防重复提交功能性能测试
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="9.2" data-path="software_process/test/EMP/Introduction.html">
            
                
                    <a href="../../../software_process/test/EMP/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                         EMP测试结果
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.2.1" >
            
            <span><b>9.2.1.</b> Android</span>
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="9.2.1.1" data-path="software_process/test/EMP/Android/offline/PresetResourceProcessingV3.0-PerformanceTestReport_1.1.html">
            
                
                    <a href="../../../software_process/test/EMP/Android/offline/PresetResourceProcessingV3.0-PerformanceTestReport_1.1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.1.1.</b>
                        
                         预置离线资源处理V3.0-性能测试报告
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="10" data-path="client_function/Introduction.html">
            
                
                    <a href="../../../client_function/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                         客户端其他功能
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="10.1" data-path="client_function/error_check.html">
            
                
                    <a href="../../../client_function/error_check.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                         错误检测
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="11" data-path="technology_accumulation/Introduction.html">
            
                
                    <a href="../../../technology_accumulation/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                         技术积累
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="11.1" data-path="technology_accumulation/Introduction.html">
            
                
                    <a href="../../../technology_accumulation/Introduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                         iOS
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="11.1.1" data-path="technology_accumulation/iOS/schedule.html">
            
                
                    <a href="../../../technology_accumulation/iOS/schedule.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.1.</b>
                        
                         日程安排
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.2" data-path="technology_accumulation/iOS/technical_points/loop_reference.html">
            
                
                    <a href="../../../technology_accumulation/iOS/technical_points/loop_reference.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.2.</b>
                        
                         循环引用
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.3" data-path="technology_accumulation/iOS/technical_points/table_cell_reuse.html">
            
                
                    <a href="../../../technology_accumulation/iOS/technical_points/table_cell_reuse.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.3.</b>
                        
                         tableCell重用
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.4" data-path="technology_accumulation/iOS/advanced_technology/3DTouch.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/3DTouch.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.4.</b>
                        
                         3DTouch
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.5" data-path="technology_accumulation/iOS/advanced_technology/cordova.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/cordova.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.5.</b>
                        
                         cordova
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.6" data-path="technology_accumulation/iOS/advanced_technology/touchID.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/touchID.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.6.</b>
                        
                         touchID
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11.1.7" data-path="technology_accumulation/iOS/advanced_technology/watchOS.html">
            
                
                    <a href="../../../technology_accumulation/iOS/advanced_technology/watchOS.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.7.</b>
                        
                         watchOS
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    

    
    
    
    

    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown">下载</a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                
                <a href="/emp/inner_docs/inner_docs.zip" class="button">html</a>
                
                
                <a href="/emp/inner_docs/book.pdf" class="button">pdf</a>
                
                
                <a href="" class="button">epub</a>
                
            </div>
        </div>
    </div>

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../" >产品文档</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_94">
                    
                        <h1 id="离线资源优化-服务端设计">离线资源优化 - 服务端设计</h1>
<!-- toc -->
<ul>
<li><a href="#需求">需求</a></li>
<li><a href="#网络传输优化">网络传输优化</a><ul>
<li><a href="#名词解释">名词解释</a></li>
<li><a href="#离线资源更新描述">离线资源更新描述</a><ul>
<li><a href="#离线资源变更-服务端处理">离线资源变更-服务端处理</a></li>
<li><a href="#管理后台-测试接口">管理后台-测试接口</a></li>
</ul>
</li>
<li><a href="#离线资源下载">离线资源下载</a><ul>
<li><a href="#外部接口变更">外部接口变更</a></li>
<li><a href="#服务端内部变更">服务端内部变更</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#实时更新">实时更新</a></li>
<li><a href="#交行离线升级方案设计">交行离线升级方案设计</a><ul>
<li><a href="#离线版本hash追加时间信息">离线版本hash追加时间信息</a></li>
<li><a href="#离线资源备份回退功能">离线资源备份、回退功能</a><ul>
<li><a href="#离线资源备份">离线资源备份</a></li>
<li><a href="#离线资源回退">离线资源回退</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#离线40完整版-附录">离线4.0完整版-附录</a><ul>
<li><a href="#span-id-localdesc服务端本地描述内容span"><span id = "local_desc">服务端本地描述内容</span></a></li>
<li><a href="#span-id-updatedesc服务端返回描述内容span"><span id = "update_desc">服务端返回描述内容</span></a></li>
<li><a href="#span-id-presetdesc预置资源描述内容span"><span id = "preset_desc">预置资源描述内容</span></a></li>
</ul>
</li>
<li><a href="#版本历史">版本历史</a></li>
</ul>
<!-- toc stop -->
<h2 id="需求">1 需求</h2>
<p><a href="http://dev.rytong.me/emp/inner_docs/software_process/requirement/offline/offline4.0_supplement.html" target="_blank">离线资源优化需求</a></p>
<h2 id="网络传输优化">2 网络传输优化</h2>
<p>服务端要实现以下功能：  </p>
<ul>
<li>离线资源有改变时，服务端根据离线资源的改变生成最新版本的描述。  <ul>
<li>维护各版本到最新版本的更新描述(下载列表和删除列表)。</li>
<li>更新描述区分方式：平台、分辨率进行、版本(四个hash值)。</li>
<li>各版本的更新描述需要做<code>可持久化</code>功能并有<code>清理策略</code>。</li>
</ul>
</li>
<li>简化离线4版本更新离线资源的流程。  <ul>
<li>修改<code>resource_update</code>接口传入参数。</li>
<li>修改离线4版本<code>本地描述</code>、<code>服务器返回描述</code>、<code>预置资源描述</code>的部分格式。  </li>
</ul>
</li>
</ul>
<h3 id="名词解释">2.1 名词解释</h3>
<table>
<thead>
<tr>
<th>名词</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>描述文件</td>
<td>服务端根据离线资源生成的全部更新资源列表(保存在服务端本地)</td>
</tr>
<tr>
<td>更新描述</td>
<td>服务端根据离线资源变更的内容，生成的当前版本更新资源列表(保存在服务端本地)</td>
</tr>
<tr>
<td>服务端返回描述</td>
<td>服务端根据客户端的离线版本，返回的更新资源列表</td>
</tr>
</tbody>
</table>
<h3 id="离线资源更新描述">2.2 离线资源更新描述</h3>
<h4 id="离线资源变更-服务端处理">2.2.1 离线资源变更-服务端处理</h4>
<p>通过<code>管理后台</code>或<code>脚本</code>上传、删除离线资源的方式不变，但是在服务端，需要根据离线资源的改变，生成与最新版本的<code>更新描述</code>。并且需要维护每次变更的版本与最新版本的描述差异，同时要有<code>可持久化</code>功能和<code>清理策略</code>。  </p>
<h5 id="更新描述">2.2.1.1 更新描述</h5>
<p>更新描述生成处理的时机，是在生成完新的描述文件之后。<br>在服务器刚启动时，会在同步离线资源时，在生成完描述文件后，会生成最新的更新描述；服务启动后，当有离线资源变更，在生成完描述文件后，会生成最新的更新描述，同时异步去完成旧版本的更新描述的更新处理。<br><code>更新描述</code>的处理接口名：gen_update_desc和gen_h5_update_desc。  </p>
<p>启动服务时，流程变更如下：<br><img src="images/update_desc_start.png" alt="启动服务流程图">  </p>
<p>服务端启动后，有离线资源改变时，会调用<code>gen_desc</code>或<code>write_h5_desc</code>两个生成描述文件的内部接口，同样也会生成更新描述。  </p>
<p>更新描述生成规则：  </p>
<ul>
<li><code>更新描述</code>生成触发条件：有离线资源增加、删除、修改。<br>  在管理后台批量删除本地资源时，一次请求只删除一个文件。修改成一次请求删除本次选中的所有文件。</li>
<li><code>更新描述</code>路径，在保存描述文件的路径下追加<code>update_desc</code>文件夹：<br>  public/resources/desc/update_desc/*、public/resources/sca_desc/update_desc/*、public/h5_resources/desc/update_desc/*、public/h5_resources/sca_desc/update_desc/*。<br>  在每个路径下建立<code>common</code>、<code>平台/common</code>、<code>平台/分辨率</code>的文件夹，分别管理特定平台分辨率的更新描述。  </li>
<li><code>更新描述</code>命名：AppName+平台+分辨率+描述版本+&quot;.desc&quot;。<br>  描述版本：四种资源类型(EWP必选、可选、H5必选、可选)的描述文件的hash值。<br>  每一个版本的更新描述个数：EWP类型App 8*n个(4种资源类型×2种加密方式，n为平台、分辨率的组合个数)，H5类型App 2个(1中资源类型×2种加密方式)。  </li>
<li><code>更新描述</code>内容：与离线3以前版本的resource_update的返回描述格式相同(部分字段会有变动)。  </li>
<li><code>更新描述</code>生成策略：<br>  版本序号0：<code>更新描述</code>文件内只有hash值并与最新的描述文件的hash相同。<br>  版本序号1：通过新描述文件与旧描述文件对比，内容成为序号1版本的<code>更新描述</code>，hash值与最新的描述文件的相同。<br>  版本序号2以后：通过新描述文件与旧描述文件对比，得出的内容，再与旧版本的<code>更新描述</code>合并，就可以得出，旧版本要更新到最新离线资源的新版<code>更新描述</code>了。<br>  在执行上述生成策略时，保证版本序号0、1是同步生成的，2以后的版本通过一个进程去异步更新。如果中间某个版本出现了错误，重试3次后仍有错误，则删除此版本以及以后版本的<code>更新描述</code>。有几个平台分辨率的组合就用几个进程，每一个进程按照版本序号依次生成<code>更新描述</code>。<br>  下图为<code>更新描述</code>生成策略，当出现版本序号不同，但是hash值相同的情况，这种情况是两个版本内容相同，保留最新的版本<code>更新描述</code>文件。当新旧版本的描述文件内容相同时，不做<code>更新描述</code>的版本更新。<br>  <img src="images/update_desc_method.png" alt="更新描述生成策略"><br>  如果图片不清晰，可另存到本地查看。  </li>
<li><code>更新描述</code>清理策略：根据<code>版本个数(desc_maximum)</code>和<code>时间(desc_expiry)</code>两个因素共同确定，满足任意条件即可删除符合条件的更新描述。<br>  在<code>ewp.conf</code>的<code>offline</code>配置项中，追加<code>update_desc</code>字段，desc_maximum单位：个，desc_expiry单位：分钟。<br>  启动一个定时器，每10分钟执行一次清理机制。<br>  在每个更新描述的路径下，都有一个update_desc.property，内容格式为Erlang terms，<code>{描述版本, 更新描述时间, 更新描述绝对路径}.</code><br>  <code>描述版本</code>：<code>更新描述</code>的hash值，此版本号具有唯一性，若出现重复，取<code>更新描述</code>时间最新的版本。<br>  <code>更新描述时间</code>：保证每一个版本的时间相同，取值使用：ewp_time:utc()，单位秒。<code>更新描述时间</code>的个数即为版本的个数，在执行<code>版本个数</code>清理时，按照时间排序，清理掉超出个数的最旧<code>更新描述</code>即可。  <pre><code>  版本序号0：
  {&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;, &quot;1452438727&quot;, &quot;/var/www/apps/unit-test/public/resources/desc/update_desc/common/ebank-common-320-480-aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.desc&quot;}.
  版本序号1：
  {&quot;a688bb1ff9777b178d231ba926b29ba81aeb92734a71b08ef0c230d9c775eb7e&quot;, &quot;1452439209&quot;, &quot;/var/www/apps/unit-test/public/resources/desc/update_desc/common/ebank-common-320-480-a688bb1ff9777b178d231ba926b29ba81aeb92734a71b08ef0c230d9c775eb7e.desc&quot;}.
  {&quot;1a4453f1cf057575156e6ab5b37f8a2a8acf151a2641479bb83d479fcb5fac0c&quot;, &quot;1452439209&quot;, &quot;/var/www/apps/unit-test/public/resources/desc/update_desc/common/ebank-common-320-480-1a4453f1cf057575156e6ab5b37f8a2a8acf151a2641479bb83d479fcb5fac0c.desc&quot;}.
  ...
</code></pre></li>
</ul>
<h4 id="管理后台-测试接口">2.2.2 管理后台-测试接口</h4>
<p>在管理后台-离线资源配置页面，追加“修改网络阈值”、“修改清理更新描述的策略”、“更新描述版本查看”功能。<br>在<code>离线资源配置</code>页面追加这三项配置的修改处理。<br>“修改网络阈值”：可以修改不同网络环境的阈值。<br>“修改清理更新描述的策略”：可修改<code>版本个数(desc_maximum)</code>和<code>时间(desc_expiry)</code>，并有<code>立即执行清理策略</code>的功能。<br>“更新描述版本查看”：可以查看当前所有版本的旧描述  </p>
<h3 id="离线资源下载">2.3 离线资源下载</h3>
<p>修改后的大致流程如下：  </p>
<p><img src="images/resource_update_flow_chart.png" alt="离线资源更新程序流程图">  </p>
<h4 id="外部接口变更">2.3.1 外部接口变更</h4>
<p>离线4.0以后，由于交互流程的改变，请求的参数也做了一些调整。<strong>离线3版本以前的参数不变</strong><br>建立信道时(exchange和handshake)，客户端的参数：  </p>
<ul>
<li>URL中的参数：  <ul>
<li>离线版本： res_ver (1.0/2.0/2.1/3.0/4.0)  </li>
<li>平台： platform  </li>
<li>分辨率： resolution  </li>
<li>客户端网络状态 network (2G/3G/4G/WIFI/UNKNOWN/自定义)  </li>
</ul>
</li>
<li>body中的参数：  <ul>
<li>EWP必选S值： hash  </li>
<li>EWP可选S值： option_hash  </li>
<li>H5必选S值： h5_hash  </li>
<li>H5可选S值： h5_option_hash  </li>
</ul>
</li>
</ul>
<p>信道建立后，再请求resource_update接口的参数，保存在body里：  </p>
<ul>
<li>离线版本： version (1.0/2.0/2.1/3.0/4.0)  </li>
<li>平台： platform  </li>
<li>分辨率： resolution  </li>
<li>多AppName： from  </li>
<li>EWP必选S值： hash  </li>
<li>EWP可选S值： option_hash  </li>
<li>H5必选S值： h5_hash  </li>
<li>H5可选S值： h5_option_hash  </li>
<li>信道建立后不带“客户端网络状态”参数。  </li>
</ul>
<p>resource_update接口的返回内容也有部分变更。<br>离线4以后，需要将<code>resource_hash</code>的一些特殊字段<code>&quot;st&quot;</code>，整合到<code>resource_update</code>里面。<br><code>&quot;st&quot;</code>：安全传输的方式，0/1/2/3。<br><code>&quot;cd&quot;</code>：contain desc，在建立信道流程中，返回描述的大小超过了服务器配置的阈值时，则会有<code>cd</code>字段，1表示含有更新描述，0表示没有更新描述。其他情况则没有<code>cd</code>这个字段。客户端根据这个字段，去判断是否需要后续的更新处理。<br><code>&quot;tu&quot;</code>：全量更新，比如，客户端必选资源与服务端完全不一致，就包含此字段，<code>&quot;l&quot;</code>字段内的资源列表就是当时服务端上的所有必选资源。为1表示全量更新；为0表示非全量（为0时没有该字段）</p>
<pre><code>{
    &quot;h&quot;:&quot;http://127.0.0.1:4002/&quot;,   //http下载地址
    &quot;w&quot;:&quot;ws://192.168.64.220:4004&quot;, //Websocket下载地址
    &quot;t&quot;:4060,   //tcp下载端口
    &quot;m&quot;:0,      //资源更新提示方式。0为提示可选更新，1为提示强制更新，-1为不更新
    &quot;st&quot;:0,     //安全传输的方式
    &quot;cd&quot;:1      //本次更新是否包含更新描述
}
</code></pre><p>服务端返回描述新增字段有：<code>&quot;st&quot;</code>、<code>&quot;cd&quot;</code>、<code>&quot;tu&quot;</code>、<code>&quot;f&quot;</code>、<code>&quot;od&quot;</code>、<code>h5_od</code>。  </p>
<ul>
<li><code>&quot;st&quot;</code>、<code>&quot;cd&quot;</code>只出现在返回描述的最外层。  </li>
<li><code>&quot;tu&quot;</code>出现在四种离线资源类型的外层。如<code>&quot;l&quot;:{&quot;tu&quot;:1 ...}</code>、<code>&quot;o&quot;:{&quot;tu&quot;:1 ...}</code>  </li>
<li><code>&quot;f&quot;</code>表示文件大小。根据该字段所在的层结构，表示在该层结构下包含的所有离线资源文件的大小。  <ul>
<li>此字段与<a href="http://dev.rytong.me/emp/inner_docs/software_process/design/offline/offline_4_0_design_server.html#%E5%A4%A7%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E6%9B%B4%E6%96%B0" target="_blank">大文件资源更新</a>中的<code>size</code>字段含义相同，保留<code>&quot;f&quot;</code>，合并两个字段出现的位置。</li>
<li><code>&quot;f&quot;</code>字段的值，只保留小数点后1位有效数字，单位&quot;m/k/b&quot;，数值为向上取整。如，&quot;1025b&quot;记录为&quot;1.1k&quot;、&quot;1234567b&quot;记录为&quot;1.2m&quot;  </li>
</ul>
</li>
<li><code>&quot;od&quot;</code>、<code>&quot;h5_od&quot;</code>表示可选资源的删除内容，与<code>&quot;d&quot;</code>、<code>&quot;h5_d&quot;</code>内容格式相同。  </li>
</ul>
<p>带有&quot;描述文件&quot;的返回描述，请参考<a href="#update_desc">完整版-服务端返回描述内容</a><br>预置资源描述，请参考<a href="#preset_desc">完整版-预置资源描述内容</a>  </p>
<h4 id="服务端内部变更">2.3.2 服务端内部变更</h4>
<h5 id="resourceupdate">2.3.2.1 resource_update</h5>
<p>目前<code>resource_update</code>接口有8和9个参数两种。离线4版本以后，在后面追加两个参数<code>ResHashes</code>、<code>Network</code>。  </p>
<pre><code>resource_update(..., ResHashes, Network) -&gt; {obj, Lists}

Types:
    ResHashes = {Hash :: list(), OptHash :: list(), 
                 H5Hash :: list(), H5OptHash :: list()}
    Network = 2G/3G/4G/WIFI/UNKNOWN/自定义 :: list()
    自定义:项目组可根据实际情况自行扩展网络类型，但必须与客户端传送的参数相同
    Lists = [{Key :: list(), Value :: term()}, ...]
</code></pre><p>resource_update公共处理 如下：  </p>
<p><img src="images/resource_update_normal.png" alt="resource_update公共处理">  </p>
<p>需要注意的是：<br>可选资源现在的处理与必选资源插件包的规则一样，只返回应该更新的部分，而不是完整的插件包。<br>对于确保更新&quot;u&quot;字段，如果整个包所有资源都是确保更新的内容，则无需在&quot;c&quot;字段带有&quot;u&quot;，而是写在与&quot;c&quot;同级的地方。  </p>
<p>服务端本地描述文件，请参考<a href="#local_desc">完整版-服务端本地描述内容</a>  </p>
<h5 id="自定义网络环境配置">2.3.2.2 自定义网络环境配置</h5>
<p>在<code>ewp.conf</code>的<code>offline</code>配置项中，追加<code>network</code>字段，表示配置网络环境支持返回描述的最大阈值。  </p>
<pre><code>{offline, [
    {network, [{&quot;2G&quot;, 50},          %% 网络类型必须与客户端参数相同，
               {&quot;3G&quot;, 200},         %% 数值单位：Kb，
               {&quot;4G&quot;, 1024},        %% 若没有与客户端匹配的值，
               {&quot;WIFI&quot;, 10240},     %% 则使用default，若没配置
               {&quot;UNKNOWN&quot;, 100},    %% 使用系统默认值100K。
               {自定义Key, Value}, 
               {default, 100}
              ]},
    ...
]}.
</code></pre><p>此配置内容，用于客户端建立信道时，找出参数Network对应的返回描述的最大阈值。<br>若Network的值在配置中匹配不到，则使用默认值。默认值为：<code>default</code>对应的配置，若没配置则使用系统默认值100k；若Network取值为<code>undefined</code>，即客户端没有传网络环境的参数，这种情况为建立信道以外的resource_update请求，不用判断阈值，直接返回对应的返回描述。</p>
<h2 id="实时更新">3 实时更新</h2>
<p>追加实时请求离线文件接口<code>ota/rt_resource</code>，&quot;real time resource&quot;。<br>为使得客户端能够准确的找到请求的文件，请求参数如下：  </p>
<ul>
<li>离线版本： version (1.0/2.0/2.1/3.0/4.0)  </li>
<li>平台： platform  </li>
<li>分辨率： resolution  </li>
<li>多AppName： from  </li>
<li>资源类型：filetype 参数值：ewp/h5</li>
<li>文件名： filename  </li>
</ul>
<p>功能介绍：<br>此接口的查找范围只限于离线资源。查找资源路径优先级：平台分辨率相符 &gt; 相同平台相近分辨率 &gt; common路径。<br>确认资源路径后，就可以根据filetype、filename去查找资源了。对于插件类型的资源来说filename是一个相对路径，而普通资源则是单纯一个文件名，所以可以借此方式，来判断普通、插件类型的资源，这样就可以直接拼路径找到客户端想要的文件了。<br>尽管如此，在实际项目开发中，<strong>尽量避免同名资源的出现</strong>。  </p>
<h2 id="交行离线升级方案设计">4 交行离线升级方案设计</h2>
<ul>
<li>交行离线升级方案设计内容<ul>
<li>离线版本hash(更新描述的s字段)追加时间信息</li>
<li>离线资源备份、回退功能</li>
</ul>
</li>
</ul>
<h3 id="离线版本hash追加时间信息">4.1 离线版本hash追加时间信息</h3>
<p>解决问题：<br>假设有20台EWP服务器，投产时是停一半，先对这一半做投产；另一半继续交易。如果第一批投产后，拿手机客户端去连接，会生成最新版本的版本号，并给手机下载最新离线资源包；这时第二批EWP还未停，该手机再连到这批老EWP版本时，就会查不到手机上的版本号，按照现有方案，就会下载全量客户端包了。  </p>
<p>目标：让客户端始终保持最新版本的离线资源。  </p>
<p>解决方法：<br>在离线资源包生成时（不管通过管理后台生成还是脚本生成），需要给离线资源版本号打一个时间戳。生成描述文件时，追加一个时间戳字段&quot;utc&quot;。服务器在生成资源描述时，需要将时间戳信息作为版本hash的后缀拼接，然后作为s值传给客户端。<br>服务器在比对客户端请求的s值时，先比对时间戳信息，如果客户端时间戳比服务器时间戳要新，那就视作客户端已经在别的服务器获取了最新的离线资源，返回不需要更新；如果客户端时间戳比服务器时间戳要旧，在比对版本hash，判断是否需要更新。<br>服务器需要兼容只有版本hash，没有时间戳的情况。  </p>
<p>影响范围：服务端<code>ewp_resource:gen_desc</code>、<code>ewp_resource:resource_update</code>接口  </p>
<h3 id="离线资源备份回退功能">4.2 离线资源备份、回退功能</h3>
<h4 id="离线资源备份">4.2.1 离线资源备份</h4>
<p>此功能是通过脚本触发，由于此功能使用频率不高，可以设计成：将所有离线资源压缩成一个zip包，保存到指定路径。
影响范围：服务端ewp_ctrl脚本和<code>ewp_ctrl</code>、<code>admin_resource</code>模块。</p>
<h4 id="离线资源回退">4.2.2 离线资源回退</h4>
<p>通过脚本触发，将回退的指定版本的离线zip包解压到离线资源路径下，并重新生成全部离线资源的描述文件。<br>影响范围：服务端ewp_ctrl脚本和<code>ewp_ctrl</code>、<code>admin_resource</code>模块。</p>
<h2 id="离线40完整版-附录">5 离线4.0完整版-附录</h2>
<h3 id="span-id-localdesc服务端本地描述内容span">5.1 <span id = "local_desc">服务端本地描述内容</span></h3>
<pre><code>{
    &quot;l&quot;: { //必选下载资源描述
        &quot;home.html&quot;: {
            &quot;e&quot;: 0, //加密标记，0为不加密，1为加密。默认为0
            &quot;r&quot;: &quot;ad4d26cc1dcc7210b6f7…&quot;, // 文件哈希值
            &quot;f&quot;: &quot;1.1m&quot;, //下载资源的文件大小
            &quot;p&quot;: &quot;iphone/320*480/html&quot;, // 文件存放相对路径
            &quot;u&quot;: 1//确保更新标记。1为确保，反之为0。默认为0
            &quot;n&quot;: &quot;普通资源说明&quot;
        },
        &quot;home.zip&quot;: {
            &quot;r&quot;: &quot;ad4d26cc1dcc7210b6f7…&quot;,
            &quot;f&quot;: &quot;1.1m&quot;, //下载资源的文件大小
            &quot;p&quot;: &quot;common/zip&quot;,
            &quot;e&quot;: 0,
            &quot;n&quot;: &quot;普通资源说明&quot;
            &quot;c&quot;: { //插件资源包里的各资源描述
                &quot;home/index.xhtml&quot;: {
                    &quot;r&quot;:&quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;,
                    &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                    &quot;u&quot;: 1
                },
                &quot;home/hello.xhtml&quot;: {
                    &quot;r&quot;:&quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;,
            &quot;f&quot;:&quot;1.1m&quot; //下载资源的文件大小
                },
                ......
            }
        },
        ...
    },
    &quot;o&quot;: { //可选下载资源描述，格式与必选资源相同
        &quot;home.zip&quot;: {
            &quot;p&quot;: &quot;common/zip&quot;,
            &quot;r&quot;: &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;,
            &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
            &quot;e&quot;:0,
            &quot;n&quot; : &quot;插件包说明&quot;
            &quot;u&quot;: 1, //当整个插件包全为确保更新，与&quot;c&quot;同级。 
            &quot;c&quot;: { //插件资源包里的各资源描述
                &quot;home/index.xhtml&quot;: {
                    &quot;r&quot;:&quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;,
                    &quot;f&quot;:&quot;1.1m&quot; //下载资源的文件大小
                },
                ......
            }
        },
        ...
    },
    &quot;h5&quot;: { //h5 必选资源描述
        &quot;path/file1&quot; : { // 如: &quot;demo/img/welcome.png&quot;
            &quot;p&quot; : &quot;h5&quot;,  // h5 普通资源路径，固定值&quot;h5&quot;
            &quot;mime&quot; : MimeType,  // 如: &quot;text/plain&quot;、&quot;image/png&quot;...
            &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;,
            &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
            &quot;e&quot; : 1,  //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
            &quot;u&quot; : 1,  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
            &quot;n&quot; : &quot;普通资源说明&quot;
        },
        &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
        {
            &quot;p&quot; : &quot;h5_plugins&quot;, //h5 插件资源路径，固定值&quot;h5_plugins&quot;
            &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
            &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
            &quot;e&quot; : 1     //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
            &quot;n&quot; : &quot;插件包说明&quot;
            &quot;c&quot; :       //需要下载文件的列表
            {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,
                            //如: account/xhtml/index.xml
                {
                    &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                    &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                    &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 
                            //默认为0,且如果为默认,则省略此字段
                    &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                }
            }
        }
        ......//其他 h5 必选资源
    },
    &quot;h5_o&quot; : {  //h5 可选资源描述。可选资源不包含普通资源
        &quot;zip2.zip&quot; : //zip包中部分文件的更新 如: account.zip
        {
            &quot;p&quot; : &quot;h5_plugins&quot;, //h5 插件资源路径，固定值&quot;h5_plugins&quot;
            &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
            &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
            &quot;e&quot; : 1     //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
            &quot;n&quot; : &quot;插件包说明&quot;
            &quot;c&quot; :       //需要下载文件的列表
            {
                &quot;file1&quot; :   //file1为相对于zip2的相对路径,
                            //如: account/xhtml/index.xml
                {
                    &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                    &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                    &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 
                            //默认为0,且如果为默认,则省略此字段
                    &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                }
            }
        },
        ......//其他 h5 可选资源
    }
}
</code></pre><h3 id="span-id-updatedesc服务端返回描述内容span">5.2 <span id = "update_desc">服务端返回描述内容</span></h3>
<pre><code>{
    &quot;h&quot;:&quot;http://127.0.0.1:4002/&quot;,   //http下载地址
    &quot;w&quot;:&quot;ws://192.168.64.220:4004&quot;, //Websocket下载地址
    &quot;t&quot;:4060,   //tcp下载端口
    &quot;m&quot;:0,      //资源更新提示方式。0为提示可选更新，1为提示强制更新，-1为不更新
    &quot;st&quot;:0,     //安全传输的方式
    &quot;l&quot; :       //必选下载资源描述
    {
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
        //必选资源hash 服务端计算的必选下载资源描述的哈希值，
        //客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
        &quot;tu&quot;:1, //是否全量更新，1表示全量更新；0表示非全量更新；为0时没有该字段
        &quot;f&quot;:&quot;1.1m&quot;,     //下载资源的文件大小
        &quot;file_path&quot;:    //普通资源路径,如&quot;ebank/resources/common/txt&quot;
        {
            &quot;file1&quot;:
            {
                &quot;r&quot;:&quot;6c6046e40e1e582529eeceec680fd573a2275f78&quot;,
                &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                &quot;e&quot;:1,      //1,加密, 0,不加密 默认为0,为0时省略此字段
                &quot;u&quot;:1,      //1,确保更新, 0,非确保更新 
                            //默认为0,且如果为默认,则省略此字段
                &quot;n&quot; : &quot;普通资源说明&quot;
            }
        },
        &quot;zip_path&quot;:     //插件资源路径,如&quot;ebank/resources/common/zip&quot;
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;a&quot; : 1,  //是否下载整个zip包，1为是，0为否。
                          //默认为1, 且如果为默认,则省略此字段。
                &quot;c&quot; :     //需要下载文件的列表
                {
                    &quot;file1&quot; :   //file1为相对于zip1的相对路径,
                                //如: account/xhtml/index.xml
                    {
                        &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                        &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                        &quot;u&quot;: 1      //1,确保更新, 0,非确保更新 
                                    //默认为0,且如果为默认,则省略此字段
                    }
                }
            }
        },
        ...     //其他EWP必选资源
    },

    &quot;d&quot; :       //EWP删除资源描述
    [
        {&quot;zip1.zip&quot; :
            [
                &quot;file3&quot;,
                &quot;file4&quot;
            ]
        },
        &quot;file5&quot;,
        &quot;file6&quot;,
        &quot;zip2.zip&quot;
    ],

    &quot;o&quot; : {     //可选下载资源描述
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
        //可选资源hash 服务端计算的可选下载资源描述的哈希值，
        //客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
        &quot;tu&quot;:1, //是否全量更新，1表示全量更新；0表示非全量更新；为0时没有该字段
        &quot;zip_path&quot;:     //插件资源路径,如&quot;ebank/resources/common/zip&quot;
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
                &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;a&quot; : 1,  //是否下载整个zip包，1为是，0为否。
                          //默认为1, 且如果为默认,则省略此字段。
                &quot;c&quot; :     //需要下载文件的列表
                {
                    &quot;file1&quot; :   //file1为相对于zip1的相对路径,
                                //如: account/xhtml/index.xml
                    {
                        &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                        &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                        &quot;u&quot; : 1      //1,确保更新, 0,非确保更新 
                                     //默认为0,且如果为默认,则省略此字段
                    }
                }
            }
        },
        ...     //其他EWP可选资源
    },

    &quot;od&quot; :       //EWP可选资源删除资源描述
    [
        {&quot;zip1.zip&quot; :
            [
                &quot;file3&quot;,
                &quot;file4&quot;
            ]
        },
        &quot;zip2.zip&quot;
    ],

    &quot;h5&quot; :      //本地H5必选下载资源描述
    {
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
        //H5必选资源hash 服务端计算的可选下载资源描述的哈希值，
        //客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
        &quot;tu&quot;:1, //是否全量更新，1表示全量更新；0表示非全量更新；为0时没有该字段
        &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
        &quot;h5&quot;:           // h5 普通资源路径，固定值&quot;h5&quot;
        {
            &quot;file1&quot; :   // h5的普通资源中,可以包含资源路径,如:&quot;mobs/html/main.html&quot;
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                &quot;e&quot; : 1 //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
                &quot;u&quot; : 1 //1,确保更新, 0,非确保更新 
                        //默认为0,且如果为默认,则省略此字段
                &quot;mime&quot; : MimeType,  // 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                &quot;n&quot; : &quot;普通资源说明&quot;
            },
            ......//其他 h5 普通资源
        },
        &quot;h5_plugins&quot; :  //h5 插件资源路径，固定值&quot;h5_plugins&quot;
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
              &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
              &quot;n&quot; : &quot;插件包说明&quot;
              &quot;a&quot; : 1,  //是否下载整个zip包，1为是，0为否。
                        //默认为1, 且如果为默认,则省略此字段。
              &quot;c&quot; :     //需要下载文件的列表
              {
                &quot;file1&quot; :   //file1为相对于zip1的相对路径,
                            //如: account/xhtml/index.xml
                {
                  &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                  &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                  &quot;u&quot;: 1    //1,确保更新, 0,非确保更新 
                            //默认为0,且如果为默认,则省略此字段
                  &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                }
              }
            }
            ......// 其他 h5 插件资源
        }
    },

    &quot;h5_d&quot; :       //本地H5必选资源删除描述
    [
        {&quot;zip1.zip&quot; :
            [
                &quot;file3&quot;,
                &quot;file4&quot;
            ]
        },
        &quot;file5&quot;,
        &quot;file6&quot;,
        &quot;zip2.zip&quot;
    ],

    &quot;h5_o&quot; : {      //本地H5可选下载资源描述
       &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
       // H5可选资源hash 服务端计算的可选下载资源描述的哈希值，
       // 客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
       &quot;tu&quot;:1, //是否全量更新，1表示全量更新；0表示非全量更新；为0时没有该字段
       &quot;h5_plugins&quot; :  //h5 插件资源路径，固定值&quot;h5_plugins&quot;
        {
            &quot;zip2.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
              &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
              &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
              &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
              &quot;n&quot; : &quot;插件包说明&quot;
              &quot;a&quot; : 1,  //是否下载整个zip包，1为是，0为否。
                        //默认为1, 且如果为默认,则省略此字段。
              &quot;c&quot; :     //需要下载文件的列表
              {
                &quot;file1&quot; :   //file1为相对于zip2的相对路径,
                            //如: account/xhtml/index.xml
                {
                  &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                  &quot;f&quot;:&quot;1.1m&quot;, //下载资源的文件大小
                  &quot;u&quot; : 1    //1,确保更新, 0,非确保更新 
                             //默认为0,且如果为默认,则省略此字段
                  &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                }
              }
            }
            ......// 其他 h5 可选插件资源
        }
    },

    &quot;h5_od&quot; :       //本地H5可选资源删除描述
    [
        {&quot;zip1.zip&quot; :
            [
                &quot;file3&quot;,
                &quot;file4&quot;
            ]
        },
        &quot;zip2.zip&quot;
    ]

}
</code></pre><h3 id="span-id-presetdesc预置资源描述内容span">5.3 <span id = "preset_desc">预置资源描述内容</span></h3>
<pre><code>{
    &quot;l&quot; : { //EWP必选资源描述
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
        //必选资源hash 服务端计算的必选下载资源描述的哈希值，
        //客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
        &quot;file_path&quot;:    //普通资源路径,如&quot;ebank/resources/common/txt&quot;
        {
            &quot;file1&quot;:
            {
                &quot;r&quot;:&quot;6c6046e40e1e582529eeceec680fd573a2275f78&quot;,
                &quot;e&quot;:1,      //1,加密, 0,不加密 默认为0,为0时省略此字段
                &quot;n&quot; : &quot;普通资源说明&quot;
            }
        },
        &quot;zip_path&quot;:     //插件资源路径,如&quot;ebank/resources/common/zip&quot;
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;c&quot; :     //需要下载文件的列表
                {
                    &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                }
            }
        },
        ...     //其他EWP必选资源
    },
    &quot;p&quot; : { //预置EWP可选资源描述，下载预置资源包时，选择下载可选资源，有此内容。
        &quot;zip2.zip&quot; : 
        {
           &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
           &quot;e&quot; : 1 //如果不需要加密存储,则没有此字段
           &quot;c&quot; : 
           {
                &quot;file1&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
           }
        }
    },
    &quot;o&quot;: { //EWP可选资源描述
        &quot;w&quot; : &quot;ws://192.168.64.220:4004&quot;, //Websocket下载地址
        &quot;t&quot; : 4060, //tcp下载端口
        &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
        &quot;dir1&quot; :  //如: ebank/resources/common/zip
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;c&quot; : //需要下载文件的列表
                {
                    &quot;file1&quot; :   //file1为相对于zip1的相对路径,如: account/xhtml/index.xml
                    {
                        &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                        &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                        &quot;u&quot; : 1  //1,确保更新, 0,非确保更新 默认为0,且如果为默认,则省略此字段
                    }
                }
            }
        }
    },
    &quot;h5&quot; : //预置h5必选下载资源描述
    {
        &quot;s&quot;:&quot;21468cbc6559727548342f5c6fa0915c01a6a1ea&quot;,
        //必选资源hash 服务端计算的必选下载资源描述的哈希值，
        //客户端将该哈希值保存，作为建立信道、ota/resource_update接口参数使用。
        &quot;file_path&quot;:    //普通资源路径,如&quot;ebank/resources/common/txt&quot;
        {
            &quot;file1&quot;:
            {
                &quot;r&quot;:&quot;6c6046e40e1e582529eeceec680fd573a2275f78&quot;,
                &quot;e&quot;:1,      //1,加密, 0,不加密 默认为0,为0时省略此字段
                &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                &quot;n&quot; : &quot;普通资源说明&quot;
            }
        },
        &quot;zip_path&quot;:     //插件资源路径,如&quot;ebank/resources/common/zip&quot;
        {
            &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;c&quot; :     //需要下载文件的列表
                {
                    &quot;file1&quot; :   //file1为相对于zip2的相对路径,
                                //如: account/xhtml/index.xml
                    {
                        &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                        &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                    }
                }
            }
        },
        ...     //其他H5必选资源
    },
    &quot;h5_p&quot; : {  // 预置h5 可选资源描述
        &quot;zip1.zip&quot; : //zip包中部分文件的更新 如: account.zip
        {
            &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
            &quot;e&quot; : 1   //1,加密, 0,不加密 默认为0,且如果为默认,则省略此字段
            &quot;n&quot; : &quot;插件包说明&quot;
            &quot;c&quot; :     //需要下载文件的列表
            {
                &quot;file1&quot; :   //file1为相对于zip2的相对路径,
                            //如: account/xhtml/index.xml
                {
                    &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                    &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                }
            }
        },
        ...     //其他H5可选资源
    },
    &quot;h5_o&quot; : {  //服务器所有h5可选资源描述。可选资源不包含普通资源
        &quot;w&quot; : &quot;ws://192.168.64.220:4004&quot;, //Websocket下载地址
        &quot;t&quot; : 4060, //tcp下载端口
        &quot;s&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
        // 对h5可选资源描述计算出的哈希值
        &quot;h5_plugins&quot; :   //h5 插件资源路径，固定值&quot;h5_plugins&quot;
        {
            &quot;zip2.zip&quot; : //zip包中部分文件的更新 如: account.zip
            {
                &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                &quot;n&quot; : &quot;插件包说明&quot;
                &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                &quot;c&quot; :       //需要下载文件的列表
                {
                    &quot;file1&quot; :   //file1为相对于zip2的相对路径,
                                //如: account/xhtml/index.xml
                    {
                        &quot;r&quot; : &quot;c4f3cffb7d68e63531c60e74611a2d2f569173e7&quot;
                        &quot;f&quot; : &quot;1.1m&quot;, //下载资源的文件大小
                        &quot;u&quot;: 1  //1,确保更新, 0,非确保更新 
                                //默认为0,且如果为默认,则省略此字段
                        &quot;mime&quot; : MimeType  // 新增 如: &quot;text/plain&quot;、&quot;image/png&quot;...
                    }
                }
            },
            ......//其他 h5 可选资源
        }
    }
}
</code></pre><h2 id="版本历史">6 版本历史</h2>
<table>
<thead>
<tr>
<th>版本号</th>
<th>日期</th>
<th>作者</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>v1.0.0</td>
<td>2016.01.05</td>
<td>于鑫(yu.xin1)</td>
<td>初稿</td>
</tr>
<tr>
<td>v1.0.1</td>
<td>2016.01.11</td>
<td>于鑫(yu.xin1)</td>
<td>追加&quot;更新描述&quot;生成策略</td>
</tr>
<tr>
<td>v1.0.2</td>
<td>2016.01.17</td>
<td>于鑫(yu.xin1)</td>
<td>2016-01-11 评审修正</td>
</tr>
<tr>
<td>v1.0.3</td>
<td>2016.02.21</td>
<td>于鑫(yu.xin1)</td>
<td>离线优化-离线版本时间戳方案</td>
</tr>
</tbody>
</table>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../../software_process/design/offline/offline_resource_optimization_client.html" class="navigation navigation-prev " aria-label="Previous page: 离线资源优化-客户端设计"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../../software_process/design/offline/offline_resource_optimization_pre&amp;download_android.html" class="navigation navigation-next " aria-label="Next page: 离线资源优化-预置&amp;下载-Android"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
